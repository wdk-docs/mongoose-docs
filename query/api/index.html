



<!DOCTYPE html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Mongodb NodeJs 组件中文文档">
      
      
      
        <meta name="author" content="Nosy">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="zh">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.2.5">
    
    
      
        <title>查询 - Mongoose文档</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.bcabdff3.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.792431c1.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    
      <body data-md-color-primary="indigo" data-md-color-accent="indigo">
    
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Mongoose文档" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Mongoose文档
              </span>
              <span class="md-header-nav__topic">
                查询
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/wohugb/mongoose-docs" title="前往 Github 仓库" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      wohugb/mongoose-docs
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." title="前言" class="md-tabs__link">
        前言
      </a>
    
  </li>

      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../connection/guide/" title="连接" class="md-tabs__link">
          连接
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../schema/guide/" title="模式" class="md-tabs__link">
          模式
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../model/guide/" title="模型" class="md-tabs__link">
          模型
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../document/guide/" title="文档" class="md-tabs__link">
          文档
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../guide/" title="查询" class="md-tabs__link md-tabs__link--active">
          查询
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../guide/Validation/" title="其它指南" class="md-tabs__link">
          其它指南
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../api/Aggregate/" title="其它API" class="md-tabs__link">
          其它API
        </a>
      
    </li>
  

      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    Mongoose文档
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/wohugb/mongoose-docs" title="前往 Github 仓库" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      wohugb/mongoose-docs
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="前言" class="md-nav__link">
      前言
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../QuickStart/" title="快速开始" class="md-nav__link">
      快速开始
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      连接
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        连接
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../connection/guide/" title="指南" class="md-nav__link">
      指南
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connection/api/" title="API" class="md-nav__link">
      API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      模式
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        模式
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../schema/guide/" title="指南" class="md-nav__link">
      指南
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../schema/api/" title="API" class="md-nav__link">
      API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../schema/type/" title="类型API" class="md-nav__link">
      类型API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      模型
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        模型
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../model/guide/" title="指南" class="md-nav__link">
      指南
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../model/api/" title="API" class="md-nav__link">
      API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      文档
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        文档
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../document/guide/" title="指南" class="md-nav__link">
      指南
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../document/api/" title="API" class="md-nav__link">
      API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
    
    <label class="md-nav__link" for="nav-7">
      查询
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        查询
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../guide/" title="指南" class="md-nav__link">
      指南
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        查询
      </label>
    
    <a href="./" title="查询" class="md-nav__link md-nav__link--active">
      查询
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#query" title="Query()" class="md-nav__link">
    Query()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeusegeowithin" title="Query.prototype.use$geoWithin" class="md-nav__link">
    Query.prototype.use$geoWithin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypetoconstructor" title="Query.prototype.toConstructor()" class="md-nav__link">
    Query.prototype.toConstructor()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypewhere" title="Query.prototype.$where()" class="md-nav__link">
    Query.prototype.$where()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypewhere_1" title="Query.prototype.where()" class="md-nav__link">
    Query.prototype.where()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeequals" title="Query.prototype.equals()" class="md-nav__link">
    Query.prototype.equals()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeor" title="Query.prototype.or()" class="md-nav__link">
    Query.prototype.or()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypenor" title="Query.prototype.nor()" class="md-nav__link">
    Query.prototype.nor()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeand" title="Query.prototype.and()" class="md-nav__link">
    Query.prototype.and()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypegt" title="Query.prototype.gt()" class="md-nav__link">
    Query.prototype.gt()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypegte" title="Query.prototype.gte()" class="md-nav__link">
    Query.prototype.gte()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypelt" title="Query.prototype.lt()" class="md-nav__link">
    Query.prototype.lt()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypelte" title="Query.prototype.lte()" class="md-nav__link">
    Query.prototype.lte()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypene" title="Query.prototype.ne()" class="md-nav__link">
    Query.prototype.ne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypein" title="Query.prototype.in()" class="md-nav__link">
    Query.prototype.in()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypenin" title="Query.prototype.nin()" class="md-nav__link">
    Query.prototype.nin()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeall" title="Query.prototype.all()" class="md-nav__link">
    Query.prototype.all()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypesize" title="Query.prototype.size()" class="md-nav__link">
    Query.prototype.size()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototyperegex" title="Query.prototype.regex()" class="md-nav__link">
    Query.prototype.regex()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypemaxdistance" title="Query.prototype.maxDistance()" class="md-nav__link">
    Query.prototype.maxDistance()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypemod" title="Query.prototype.mod()" class="md-nav__link">
    Query.prototype.mod()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeexists" title="Query.prototype.exists()" class="md-nav__link">
    Query.prototype.exists()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeelemmatch" title="Query.prototype.elemMatch()" class="md-nav__link">
    Query.prototype.elemMatch()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypewithin" title="Query.prototype.within()" class="md-nav__link">
    Query.prototype.within()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeslice" title="Query.prototype.slice()" class="md-nav__link">
    Query.prototype.slice()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypelimit" title="Query.prototype.limit()" class="md-nav__link">
    Query.prototype.limit()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeskip" title="Query.prototype.skip()" class="md-nav__link">
    Query.prototype.skip()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypemaxscan" title="Query.prototype.maxScan()" class="md-nav__link">
    Query.prototype.maxScan()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypebatchsize" title="Query.prototype.batchSize()" class="md-nav__link">
    Query.prototype.batchSize()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypesnapshot" title="Query.prototype.snapshot()" class="md-nav__link">
    Query.prototype.snapshot()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypehint" title="Query.prototype.hint()" class="md-nav__link">
    Query.prototype.hint()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeselect" title="Query.prototype.select()" class="md-nav__link">
    Query.prototype.select()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeslaveok" title="Query.prototype.slaveOk()" class="md-nav__link">
    Query.prototype.slaveOk()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototyperead" title="Query.prototype.read()" class="md-nav__link">
    Query.prototype.read()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypemerge" title="Query.prototype.merge()" class="md-nav__link">
    Query.prototype.merge()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypesetoptions" title="Query.prototype.setOptions()" class="md-nav__link">
    Query.prototype.setOptions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypegetquery" title="Query.prototype.getQuery()" class="md-nav__link">
    Query.prototype.getQuery()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypegetupdate" title="Query.prototype.getUpdate()" class="md-nav__link">
    Query.prototype.getUpdate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypelean" title="Query.prototype.lean()" class="md-nav__link">
    Query.prototype.lean()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeerror" title="Query.prototype.error()" class="md-nav__link">
    Query.prototype.error()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypemongooseoptions" title="Query.prototype.mongooseOptions()" class="md-nav__link">
    Query.prototype.mongooseOptions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypefind" title="Query.prototype.find()" class="md-nav__link">
    Query.prototype.find()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypemerge_1" title="Query.prototype.merge()" class="md-nav__link">
    Query.prototype.merge()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypecollation" title="Query.prototype.collation()" class="md-nav__link">
    Query.prototype.collation()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypefindone" title="Query.prototype.findOne()" class="md-nav__link">
    Query.prototype.findOne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypecount" title="Query.prototype.count()" class="md-nav__link">
    Query.prototype.count()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypedistinct" title="Query.prototype.distinct()" class="md-nav__link">
    Query.prototype.distinct()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypesort" title="Query.prototype.sort()" class="md-nav__link">
    Query.prototype.sort()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototyperemove" title="Query.prototype.remove()" class="md-nav__link">
    Query.prototype.remove()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypedeleteone" title="Query.prototype.deleteOne()" class="md-nav__link">
    Query.prototype.deleteOne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypedeletemany" title="Query.prototype.deleteMany()" class="md-nav__link">
    Query.prototype.deleteMany()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypefindoneandupdate" title="Query.prototype.findOneAndUpdate()" class="md-nav__link">
    Query.prototype.findOneAndUpdate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypefindoneandremove" title="Query.prototype.findOneAndRemove()" class="md-nav__link">
    Query.prototype.findOneAndRemove()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeupdate" title="Query.prototype.update()" class="md-nav__link">
    Query.prototype.update()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeupdatemany" title="Query.prototype.updateMany()" class="md-nav__link">
    Query.prototype.updateMany()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeupdateone" title="Query.prototype.updateOne()" class="md-nav__link">
    Query.prototype.updateOne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypereplaceone" title="Query.prototype.replaceOne()" class="md-nav__link">
    Query.prototype.replaceOne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeexec" title="Query.prototype.exec()" class="md-nav__link">
    Query.prototype.exec()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypethen" title="Query.prototype.then()" class="md-nav__link">
    Query.prototype.then()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypecatch" title="Query.prototype.catch()" class="md-nav__link">
    Query.prototype.catch()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypepopulate" title="Query.prototype.populate()" class="md-nav__link">
    Query.prototype.populate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypecast" title="Query.prototype.cast()" class="md-nav__link">
    Query.prototype.cast()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypecursor" title="Query.prototype.cursor()" class="md-nav__link">
    Query.prototype.cursor()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypemaxscan_1" title="Query.prototype.maxscan()" class="md-nav__link">
    Query.prototype.maxscan()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypetailable" title="Query.prototype.tailable()" class="md-nav__link">
    Query.prototype.tailable()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeintersects" title="Query.prototype.intersects()" class="md-nav__link">
    Query.prototype.intersects()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypegeometry" title="Query.prototype.geometry()" class="md-nav__link">
    Query.prototype.geometry()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypenear" title="Query.prototype.near()" class="md-nav__link">
    Query.prototype.near()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypenearsphere" title="Query.prototype.nearSphere()" class="md-nav__link">
    Query.prototype.nearSphere()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypepolygon" title="Query.prototype.polygon()" class="md-nav__link">
    Query.prototype.polygon()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypebox" title="Query.prototype.box()" class="md-nav__link">
    Query.prototype.box()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypecircle" title="Query.prototype.circle()" class="md-nav__link">
    Query.prototype.circle()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypecenter" title="Query.prototype.center()" class="md-nav__link">
    Query.prototype.center()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypecentersphere" title="Query.prototype.centerSphere()" class="md-nav__link">
    Query.prototype.centerSphere()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeselected" title="Query.prototype.selected()" class="md-nav__link">
    Query.prototype.selected()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeselectedinclusively" title="Query.prototype.selectedInclusively()" class="md-nav__link">
    Query.prototype.selectedInclusively()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeselectedexclusively" title="Query.prototype.selectedExclusively()" class="md-nav__link">
    Query.prototype.selectedExclusively()
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      其它指南
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        其它指南
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/Validation/" title="验证" class="md-nav__link">
      验证
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/Middleware/" title="中间件" class="md-nav__link">
      中间件
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/Populate/" title="填充" class="md-nav__link">
      填充
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/Discriminators/" title="鉴别器" class="md-nav__link">
      鉴别器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/Plugins/" title="插件" class="md-nav__link">
      插件
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      其它API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        其它API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/Aggregate/" title="聚合" class="md-nav__link">
      聚合
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/VirtualType/" title="虚拟类型" class="md-nav__link">
      虚拟类型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/Error/" title="错误" class="md-nav__link">
      错误
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../VersionCompatibility/" title="版本兼容性" class="md-nav__link">
      版本兼容性
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../FAQ/" title="常问问题" class="md-nav__link">
      常问问题
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#query" title="Query()" class="md-nav__link">
    Query()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeusegeowithin" title="Query.prototype.use$geoWithin" class="md-nav__link">
    Query.prototype.use$geoWithin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypetoconstructor" title="Query.prototype.toConstructor()" class="md-nav__link">
    Query.prototype.toConstructor()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypewhere" title="Query.prototype.$where()" class="md-nav__link">
    Query.prototype.$where()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypewhere_1" title="Query.prototype.where()" class="md-nav__link">
    Query.prototype.where()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeequals" title="Query.prototype.equals()" class="md-nav__link">
    Query.prototype.equals()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeor" title="Query.prototype.or()" class="md-nav__link">
    Query.prototype.or()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypenor" title="Query.prototype.nor()" class="md-nav__link">
    Query.prototype.nor()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeand" title="Query.prototype.and()" class="md-nav__link">
    Query.prototype.and()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypegt" title="Query.prototype.gt()" class="md-nav__link">
    Query.prototype.gt()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypegte" title="Query.prototype.gte()" class="md-nav__link">
    Query.prototype.gte()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypelt" title="Query.prototype.lt()" class="md-nav__link">
    Query.prototype.lt()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypelte" title="Query.prototype.lte()" class="md-nav__link">
    Query.prototype.lte()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypene" title="Query.prototype.ne()" class="md-nav__link">
    Query.prototype.ne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypein" title="Query.prototype.in()" class="md-nav__link">
    Query.prototype.in()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypenin" title="Query.prototype.nin()" class="md-nav__link">
    Query.prototype.nin()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeall" title="Query.prototype.all()" class="md-nav__link">
    Query.prototype.all()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypesize" title="Query.prototype.size()" class="md-nav__link">
    Query.prototype.size()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototyperegex" title="Query.prototype.regex()" class="md-nav__link">
    Query.prototype.regex()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypemaxdistance" title="Query.prototype.maxDistance()" class="md-nav__link">
    Query.prototype.maxDistance()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypemod" title="Query.prototype.mod()" class="md-nav__link">
    Query.prototype.mod()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeexists" title="Query.prototype.exists()" class="md-nav__link">
    Query.prototype.exists()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeelemmatch" title="Query.prototype.elemMatch()" class="md-nav__link">
    Query.prototype.elemMatch()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypewithin" title="Query.prototype.within()" class="md-nav__link">
    Query.prototype.within()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeslice" title="Query.prototype.slice()" class="md-nav__link">
    Query.prototype.slice()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypelimit" title="Query.prototype.limit()" class="md-nav__link">
    Query.prototype.limit()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeskip" title="Query.prototype.skip()" class="md-nav__link">
    Query.prototype.skip()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypemaxscan" title="Query.prototype.maxScan()" class="md-nav__link">
    Query.prototype.maxScan()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypebatchsize" title="Query.prototype.batchSize()" class="md-nav__link">
    Query.prototype.batchSize()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypesnapshot" title="Query.prototype.snapshot()" class="md-nav__link">
    Query.prototype.snapshot()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypehint" title="Query.prototype.hint()" class="md-nav__link">
    Query.prototype.hint()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeselect" title="Query.prototype.select()" class="md-nav__link">
    Query.prototype.select()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeslaveok" title="Query.prototype.slaveOk()" class="md-nav__link">
    Query.prototype.slaveOk()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototyperead" title="Query.prototype.read()" class="md-nav__link">
    Query.prototype.read()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypemerge" title="Query.prototype.merge()" class="md-nav__link">
    Query.prototype.merge()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypesetoptions" title="Query.prototype.setOptions()" class="md-nav__link">
    Query.prototype.setOptions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypegetquery" title="Query.prototype.getQuery()" class="md-nav__link">
    Query.prototype.getQuery()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypegetupdate" title="Query.prototype.getUpdate()" class="md-nav__link">
    Query.prototype.getUpdate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypelean" title="Query.prototype.lean()" class="md-nav__link">
    Query.prototype.lean()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeerror" title="Query.prototype.error()" class="md-nav__link">
    Query.prototype.error()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypemongooseoptions" title="Query.prototype.mongooseOptions()" class="md-nav__link">
    Query.prototype.mongooseOptions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypefind" title="Query.prototype.find()" class="md-nav__link">
    Query.prototype.find()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypemerge_1" title="Query.prototype.merge()" class="md-nav__link">
    Query.prototype.merge()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypecollation" title="Query.prototype.collation()" class="md-nav__link">
    Query.prototype.collation()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypefindone" title="Query.prototype.findOne()" class="md-nav__link">
    Query.prototype.findOne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypecount" title="Query.prototype.count()" class="md-nav__link">
    Query.prototype.count()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypedistinct" title="Query.prototype.distinct()" class="md-nav__link">
    Query.prototype.distinct()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypesort" title="Query.prototype.sort()" class="md-nav__link">
    Query.prototype.sort()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototyperemove" title="Query.prototype.remove()" class="md-nav__link">
    Query.prototype.remove()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypedeleteone" title="Query.prototype.deleteOne()" class="md-nav__link">
    Query.prototype.deleteOne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypedeletemany" title="Query.prototype.deleteMany()" class="md-nav__link">
    Query.prototype.deleteMany()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypefindoneandupdate" title="Query.prototype.findOneAndUpdate()" class="md-nav__link">
    Query.prototype.findOneAndUpdate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypefindoneandremove" title="Query.prototype.findOneAndRemove()" class="md-nav__link">
    Query.prototype.findOneAndRemove()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeupdate" title="Query.prototype.update()" class="md-nav__link">
    Query.prototype.update()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeupdatemany" title="Query.prototype.updateMany()" class="md-nav__link">
    Query.prototype.updateMany()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeupdateone" title="Query.prototype.updateOne()" class="md-nav__link">
    Query.prototype.updateOne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypereplaceone" title="Query.prototype.replaceOne()" class="md-nav__link">
    Query.prototype.replaceOne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeexec" title="Query.prototype.exec()" class="md-nav__link">
    Query.prototype.exec()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypethen" title="Query.prototype.then()" class="md-nav__link">
    Query.prototype.then()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypecatch" title="Query.prototype.catch()" class="md-nav__link">
    Query.prototype.catch()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypepopulate" title="Query.prototype.populate()" class="md-nav__link">
    Query.prototype.populate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypecast" title="Query.prototype.cast()" class="md-nav__link">
    Query.prototype.cast()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypecursor" title="Query.prototype.cursor()" class="md-nav__link">
    Query.prototype.cursor()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypemaxscan_1" title="Query.prototype.maxscan()" class="md-nav__link">
    Query.prototype.maxscan()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypetailable" title="Query.prototype.tailable()" class="md-nav__link">
    Query.prototype.tailable()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeintersects" title="Query.prototype.intersects()" class="md-nav__link">
    Query.prototype.intersects()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypegeometry" title="Query.prototype.geometry()" class="md-nav__link">
    Query.prototype.geometry()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypenear" title="Query.prototype.near()" class="md-nav__link">
    Query.prototype.near()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypenearsphere" title="Query.prototype.nearSphere()" class="md-nav__link">
    Query.prototype.nearSphere()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypepolygon" title="Query.prototype.polygon()" class="md-nav__link">
    Query.prototype.polygon()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypebox" title="Query.prototype.box()" class="md-nav__link">
    Query.prototype.box()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypecircle" title="Query.prototype.circle()" class="md-nav__link">
    Query.prototype.circle()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypecenter" title="Query.prototype.center()" class="md-nav__link">
    Query.prototype.center()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypecentersphere" title="Query.prototype.centerSphere()" class="md-nav__link">
    Query.prototype.centerSphere()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeselected" title="Query.prototype.selected()" class="md-nav__link">
    Query.prototype.selected()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeselectedinclusively" title="Query.prototype.selectedInclusively()" class="md-nav__link">
    Query.prototype.selectedInclusively()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryprototypeselectedexclusively" title="Query.prototype.selectedExclusively()" class="md-nav__link">
    Query.prototype.selectedExclusively()
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="_1">查询<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="query">Query()<a class="headerlink" href="#query" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[collection] «Object» Mongoose collection</li>
</ul>
<p>Query constructor used for building queries. You do not need to instantiate a <code>Query</code> directly. Instead use Model functions like [<code>Model.find()</code>.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>const query = MyModel.find();
query.setOptions({ lean : true });
query.collection(model.collection);
query.where(&#39;age&#39;).gte(21).exec(callback);

const query = new mongoose.Query();
</pre></div>


<h2 id="queryprototypeusegeowithin">Query.prototype.use$geoWithin<a class="headerlink" href="#queryprototypeusegeowithin" title="Permanent link">&para;</a></h2>
<p>Flag to opt out of using <code>$geoWithin</code>.</p>
<div class="codehilite"><pre><span></span>mongoose.Query.use$geoWithin = false;
</pre></div>


<p>MongoDB 2.4 deprecated the use of <code>$within</code>, replacing it with <code>$geoWithin</code>. Mongoose uses <code>$geoWithin</code> by default (which is 100% backward compatible with $within). If you are running an older version of MongoDB, set this flag to <code>false</code> so your <code>within()</code> queries continue to work.</p>
<h2 id="queryprototypetoconstructor">Query.prototype.toConstructor()<a class="headerlink" href="#queryprototypetoconstructor" title="Permanent link">&para;</a></h2>
<p><strong>返回</strong></p>
<ul>
<li>«Query» subclass-of-Query</li>
</ul>
<p>Converts this query to a customized, reusable query constructor with all arguments and options retained.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><span class="nt">var</span> <span class="nt">query</span> <span class="o">=</span> <span class="nt">Movie</span><span class="p">.</span><span class="nc">find</span><span class="o">(</span><span class="p">{</span> <span class="n">tags</span><span class="p">:</span> <span class="s1">&#39;adventure&#39;</span> <span class="p">}</span><span class="o">)</span><span class="p">.</span><span class="nc">read</span><span class="o">(</span><span class="s1">&#39;primaryPreferred&#39;</span><span class="o">);</span>

<span class="nt">var</span> <span class="nt">Adventure</span> <span class="o">=</span> <span class="nt">query</span><span class="p">.</span><span class="nc">toConstructor</span><span class="o">();</span>

<span class="nt">Adventure</span><span class="o">()</span><span class="p">.</span><span class="nc">exec</span><span class="o">(</span><span class="nt">callback</span><span class="o">)</span>

<span class="nt">Adventure</span><span class="o">()</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="o">/^</span><span class="n">Life</span><span class="o">/</span> <span class="p">}</span><span class="o">)</span><span class="p">.</span><span class="nc">exec</span><span class="o">(</span><span class="nt">callback</span><span class="o">);</span>

<span class="nt">Adventure</span><span class="p">.</span><span class="nc">prototype</span><span class="p">.</span><span class="nc">startsWith</span> <span class="o">=</span> <span class="nt">function</span> <span class="o">(</span><span class="nt">prefix</span><span class="o">)</span> <span class="p">{</span>
  <span class="err">this.where({</span> <span class="n">name</span><span class="p">:</span> <span class="n">new</span> <span class="nf">RegExp</span><span class="p">(</span><span class="s1">&#39;^&#39;</span> <span class="o">+</span> <span class="n">prefix</span><span class="p">)</span> <span class="p">}</span><span class="o">)</span>
  <span class="nt">return</span> <span class="nt">this</span><span class="o">;</span>
<span class="err">}</span>
<span class="nt">Object</span><span class="p">.</span><span class="nc">defineProperty</span><span class="o">(</span><span class="nt">Adventure</span><span class="p">.</span><span class="nc">prototype</span><span class="o">,</span> <span class="s1">&#39;highlyRated&#39;</span><span class="o">,</span> <span class="p">{</span>
  <span class="n">get</span><span class="p">:</span> <span class="n">function</span> <span class="p">()</span> <span class="err">{</span>
    <span class="n">this</span><span class="o">.</span><span class="nf">where</span><span class="p">(</span><span class="err">{</span> <span class="n">rating</span><span class="err">:</span> <span class="err">{</span> <span class="err">$</span><span class="n">gt</span><span class="err">:</span> <span class="mf">4.5</span> <span class="err">}}</span><span class="p">);</span>
    <span class="err">return</span> <span class="err">this</span><span class="p">;</span>
  <span class="p">}</span>
<span class="err">}</span><span class="o">)</span>
<span class="nt">Adventure</span><span class="o">()</span><span class="p">.</span><span class="nc">highlyRated</span><span class="p">.</span><span class="nc">startsWith</span><span class="o">(</span><span class="s1">&#39;Life&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">exec</span><span class="o">(</span><span class="nt">callback</span><span class="o">)</span>
</pre></div>


<p>New in 3.7.3</p>
<h2 id="queryprototypewhere">Query.prototype.$where()<a class="headerlink" href="#queryprototypewhere" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>js «String,Function» javascript string or function</li>
</ul>
<p><strong>返回</strong></p>
<p>Specifies a javascript function or expression to pass to MongoDBs query system.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.$where(&#39;this.comments.length === 10 || this.name.length === 5&#39;)

query.$where(function () {
  return this.comments.length === 10 || this.name.length === 5;
})
</pre></div>


<p><strong>注释</strong></p>
<p>Only use <code>$where</code> when you have a condition that cannot be met using other MongoDB operators like <code>$lt</code>. <strong>Be sure to read about all of [its caveats before using.</strong></p>
<h2 id="queryprototypewhere_1">Query.prototype.where()<a class="headerlink" href="#queryprototypewhere_1" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Specifies a <code>path</code> for use with chaining.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><span class="nt">User</span><span class="p">.</span><span class="nc">find</span><span class="o">(</span><span class="p">{</span><span class="n">age</span><span class="p">:</span> <span class="err">{$</span><span class="n">gte</span><span class="o">:</span> <span class="mi">21</span><span class="p">,</span> <span class="err">$</span><span class="n">lte</span><span class="o">:</span> <span class="mi">65</span><span class="p">}</span><span class="err">}</span><span class="o">,</span> <span class="nt">callback</span><span class="o">);</span>

<span class="nt">User</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;age&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">gte</span><span class="o">(</span><span class="nt">21</span><span class="o">)</span><span class="p">.</span><span class="nc">lte</span><span class="o">(</span><span class="nt">65</span><span class="o">);</span>

<span class="nt">User</span><span class="p">.</span><span class="nc">find</span><span class="o">()</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;vonderful&#39;</span> <span class="p">}</span><span class="o">)</span>

<span class="nt">User</span>
<span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;age&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">gte</span><span class="o">(</span><span class="nt">21</span><span class="o">)</span><span class="p">.</span><span class="nc">lte</span><span class="o">(</span><span class="nt">65</span><span class="o">)</span>
<span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">,</span> <span class="o">/^</span><span class="nt">vonderful</span><span class="o">/</span><span class="nt">i</span><span class="o">)</span>
<span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;friends&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">slice</span><span class="o">(</span><span class="nt">10</span><span class="o">)</span>
<span class="p">.</span><span class="nc">exec</span><span class="o">(</span><span class="nt">callback</span><span class="o">)</span>
</pre></div>


<h2 id="queryprototypeequals">Query.prototype.equals()<a class="headerlink" href="#queryprototypeequals" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Specifies the complementary comparison value for paths specified with <code>where()</code></p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>User.where(&#39;age&#39;).equals(49);

User.where(&#39;age&#39;, 49);
</pre></div>


<h2 id="queryprototypeor">Query.prototype.or()<a class="headerlink" href="#queryprototypeor" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>array «Array» array of conditions</li>
</ul>
<p><strong>返回</strong></p>
<p>Specifies arguments for an <code>$or</code> condition.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.or([{ color: &#39;red&#39; }, { status: &#39;emergency&#39; }])
</pre></div>


<h2 id="queryprototypenor">Query.prototype.nor()<a class="headerlink" href="#queryprototypenor" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>array «Array» array of conditions</li>
</ul>
<p><strong>返回</strong></p>
<p>Specifies arguments for a <code>$nor</code> condition.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.nor([{ color: &#39;green&#39; }, { status: &#39;ok&#39; }])
</pre></div>


<h2 id="queryprototypeand">Query.prototype.and()<a class="headerlink" href="#queryprototypeand" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>array «Array» array of conditions</li>
</ul>
<p><strong>返回</strong></p>
<p>Specifies arguments for a <code>$and</code> condition.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.and([{ color: &#39;green&#39; }, { status: &#39;ok&#39; }])
</pre></div>


<h2 id="queryprototypegt">Query.prototype.gt()<a class="headerlink" href="#queryprototypegt" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p>Specifies a $gt query condition.</p>
<p>When called with one argument, the most recent path passed to <code>where()</code> is used.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>Thing.find().where(&#39;age&#39;).gt(21)

Thing.find().gt(&#39;age&#39;, 21)
</pre></div>


<h2 id="queryprototypegte">Query.prototype.gte()<a class="headerlink" href="#queryprototypegte" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p>Specifies a $gte query condition.</p>
<p>When called with one argument, the most recent path passed to <code>where()</code> is used.</p>
<h2 id="queryprototypelt">Query.prototype.lt()<a class="headerlink" href="#queryprototypelt" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p>Specifies a $lt query condition.</p>
<p>When called with one argument, the most recent path passed to <code>where()</code> is used.</p>
<h2 id="queryprototypelte">Query.prototype.lte()<a class="headerlink" href="#queryprototypelte" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p>Specifies a $lte query condition.</p>
<p>When called with one argument, the most recent path passed to <code>where()</code> is used.</p>
<h2 id="queryprototypene">Query.prototype.ne()<a class="headerlink" href="#queryprototypene" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p>Specifies a $ne query condition.</p>
<p>When called with one argument, the most recent path passed to <code>where()</code> is used.</p>
<h2 id="queryprototypein">Query.prototype.in()<a class="headerlink" href="#queryprototypein" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p>Specifies an $in query condition.</p>
<p>When called with one argument, the most recent path passed to <code>where()</code> is used.</p>
<h2 id="queryprototypenin">Query.prototype.nin()<a class="headerlink" href="#queryprototypenin" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p>Specifies an $nin query condition.</p>
<p>When called with one argument, the most recent path passed to <code>where()</code> is used.</p>
<h2 id="queryprototypeall">Query.prototype.all()<a class="headerlink" href="#queryprototypeall" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p>Specifies an $all query condition.</p>
<p>When called with one argument, the most recent path passed to <code>where()</code> is used.</p>
<h2 id="queryprototypesize">Query.prototype.size()<a class="headerlink" href="#queryprototypesize" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p>Specifies a $size query condition.</p>
<p>When called with one argument, the most recent path passed to <code>where()</code> is used.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>MyModel.where(&#39;tags&#39;).size(0).exec(function (err, docs) {
  if (err) return handleError(err);

  assert(Array.isArray(docs));
  console.log(&#39;documents with 0 tags&#39;, docs);
})
</pre></div>


<h2 id="queryprototyperegex">Query.prototype.regex()<a class="headerlink" href="#queryprototyperegex" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p>Specifies a $regex query condition.</p>
<p>When called with one argument, the most recent path passed to <code>where()</code> is used.</p>
<h2 id="queryprototypemaxdistance">Query.prototype.maxDistance()<a class="headerlink" href="#queryprototypemaxdistance" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p>Specifies a $maxDistance query condition.</p>
<p>When called with one argument, the most recent path passed to <code>where()</code> is used.</p>
<h2 id="queryprototypemod">Query.prototype.mod()<a class="headerlink" href="#queryprototypemod" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>val «Array» must be of length 2, first element is <code>divisor</code>, 2nd element is <code>remainder</code>.</li>
</ul>
<p><strong>返回</strong></p>
<p>Specifies a <code>$mod</code> condition, filters documents for documents whose <code>path</code> property is a number that is equal to <code>remainder</code> modulo <code>divisor</code>.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>Product.find().mod(&#39;inventory&#39;, [2, 1]);
Product.find().where(&#39;inventory&#39;).mod([2, 1]);

Product.find().where(&#39;inventory&#39;).mod(2, 1);
</pre></div>


<h2 id="queryprototypeexists">Query.prototype.exists()<a class="headerlink" href="#queryprototypeexists" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Specifies an <code>$exists</code> condition</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>Thing.where(&#39;name&#39;).exists()
Thing.where(&#39;name&#39;).exists(true)
Thing.find().exists(&#39;name&#39;)

Thing.where(&#39;name&#39;).exists(false);
Thing.find().exists(&#39;name&#39;, false);
</pre></div>


<h2 id="queryprototypeelemmatch">Query.prototype.elemMatch()<a class="headerlink" href="#queryprototypeelemmatch" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>criteria «Object,Function»</li>
</ul>
<p><strong>返回</strong></p>
<p>Specifies an <code>$elemMatch</code> condition</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><span class="nt">query</span><span class="p">.</span><span class="nc">elemMatch</span><span class="o">(</span><span class="s1">&#39;comment&#39;</span><span class="o">,</span> <span class="p">{</span> <span class="n">author</span><span class="p">:</span> <span class="s1">&#39;autobot&#39;</span><span class="p">,</span> <span class="n">votes</span><span class="o">:</span> <span class="err">{$</span><span class="n">gte</span><span class="o">:</span> <span class="mi">5</span><span class="p">}</span><span class="err">}</span><span class="o">)</span>

<span class="nt">query</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;comment&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">elemMatch</span><span class="o">(</span><span class="p">{</span> <span class="n">author</span><span class="p">:</span> <span class="s1">&#39;autobot&#39;</span><span class="p">,</span> <span class="n">votes</span><span class="o">:</span> <span class="err">{$</span><span class="n">gte</span><span class="o">:</span> <span class="mi">5</span><span class="p">}</span><span class="err">}</span><span class="o">)</span>

<span class="nt">query</span><span class="p">.</span><span class="nc">elemMatch</span><span class="o">(</span><span class="s1">&#39;comment&#39;</span><span class="o">,</span> <span class="nt">function</span> <span class="o">(</span><span class="nt">elem</span><span class="o">)</span> <span class="p">{</span>
  <span class="err">elem.where(&#39;author&#39;).equals(&#39;autobot&#39;)</span><span class="p">;</span>
  <span class="err">elem.where(&#39;votes&#39;).gte(5)</span><span class="p">;</span>
<span class="p">}</span><span class="o">)</span>

<span class="nt">query</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;comment&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">elemMatch</span><span class="o">(</span><span class="nt">function</span> <span class="o">(</span><span class="nt">elem</span><span class="o">)</span> <span class="p">{</span>
  <span class="err">elem.where({</span> <span class="n">author</span><span class="p">:</span> <span class="s1">&#39;autobot&#39;</span> <span class="p">}</span><span class="o">);</span>
  <span class="nt">elem</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;votes&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">gte</span><span class="o">(</span><span class="nt">5</span><span class="o">);</span>
<span class="err">}</span><span class="o">)</span>
</pre></div>


<h2 id="queryprototypewithin">Query.prototype.within()<a class="headerlink" href="#queryprototypewithin" title="Permanent link">&para;</a></h2>
<p><strong>返回</strong></p>
<p>Defines a <code>$within</code> or <code>$geoWithin</code> argument for geo-spatial queries.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><span class="nt">query</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="nt">path</span><span class="o">)</span><span class="p">.</span><span class="nc">within</span><span class="o">()</span><span class="p">.</span><span class="nc">box</span><span class="o">()</span>
<span class="nt">query</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="nt">path</span><span class="o">)</span><span class="p">.</span><span class="nc">within</span><span class="o">()</span><span class="p">.</span><span class="nc">circle</span><span class="o">()</span>
<span class="nt">query</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="nt">path</span><span class="o">)</span><span class="p">.</span><span class="nc">within</span><span class="o">()</span><span class="p">.</span><span class="nc">geometry</span><span class="o">()</span>

<span class="nt">query</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;loc&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">within</span><span class="o">(</span><span class="p">{</span> <span class="n">center</span><span class="p">:</span> <span class="cp">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="cp">]</span><span class="p">,</span> <span class="n">radius</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span> <span class="n">unique</span><span class="o">:</span> <span class="n">true</span><span class="p">,</span> <span class="n">spherical</span><span class="o">:</span> <span class="n">true</span> <span class="p">}</span><span class="o">);</span>
<span class="nt">query</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;loc&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">within</span><span class="o">(</span><span class="p">{</span> <span class="n">box</span><span class="p">:</span> <span class="cp">[</span><span class="err">[</span><span class="mf">40.73</span><span class="p">,</span> <span class="o">-</span><span class="mf">73.9</span><span class="cp">]</span><span class="p">,</span> <span class="cp">[</span><span class="mf">40.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">73.988</span><span class="cp">]</span><span class="p">]</span> <span class="p">}</span><span class="o">);</span>
<span class="nt">query</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;loc&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">within</span><span class="o">(</span><span class="p">{</span> <span class="n">polygon</span><span class="p">:</span> <span class="cp">[</span><span class="err">[</span><span class="cp">]</span><span class="p">,</span><span class="cp">[]</span><span class="p">,</span><span class="cp">[]</span><span class="p">,</span><span class="cp">[]</span><span class="p">]</span> <span class="p">}</span><span class="o">);</span>

<span class="nt">query</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;loc&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">within</span><span class="o">(</span><span class="cp">[]</span><span class="o">,</span> <span class="cp">[]</span><span class="o">,</span> <span class="cp">[]</span><span class="o">)</span>
<span class="nt">query</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;loc&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">within</span><span class="o">(</span><span class="cp">[]</span><span class="o">,</span> <span class="cp">[]</span><span class="o">)</span>
<span class="nt">query</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;loc&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">within</span><span class="o">(</span><span class="p">{</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;LineString&#39;</span><span class="p">,</span> <span class="n">coordinates</span><span class="o">:</span> <span class="cp">[</span><span class="nx">...</span><span class="cp">]</span> <span class="p">}</span><span class="o">);</span>
</pre></div>


<p><strong>MUST</strong> be used after <code>where()</code>.</p>
<p><strong>注释</strong></p>
<p>As of Mongoose 3.7, <code>$geoWithin</code> is always used for queries. To change this behavior, see [Query.use$geoWithin.</p>
<p><strong>注释</strong></p>
<p>In Mongoose 3.7, <code>within</code> changed from a getter to a function. If you need the old syntax, use [this.</p>
<h2 id="queryprototypeslice">Query.prototype.slice()<a class="headerlink" href="#queryprototypeslice" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>val «Number» number/range of elements to slice</li>
</ul>
<p><strong>返回</strong></p>
<p>Specifies a $slice projection for an array.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.slice(&#39;comments&#39;, 5)
query.slice(&#39;comments&#39;, -5)
query.slice(&#39;comments&#39;, [10, 5])
query.where(&#39;comments&#39;).slice(5)
query.where(&#39;comments&#39;).slice([-10, 5])
</pre></div>


<h2 id="queryprototypelimit">Query.prototype.limit()<a class="headerlink" href="#queryprototypelimit" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p>Specifies the maximum number of documents the query will return.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.limit(20)
</pre></div>


<p><strong>注释</strong></p>
<p>Cannot be used with <code>distinct()</code></p>
<h2 id="queryprototypeskip">Query.prototype.skip()<a class="headerlink" href="#queryprototypeskip" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p>Specifies the number of documents to skip.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.skip(100).limit(20)
</pre></div>


<p><strong>注释</strong></p>
<p>Cannot be used with <code>distinct()</code></p>
<h2 id="queryprototypemaxscan">Query.prototype.maxScan()<a class="headerlink" href="#queryprototypemaxscan" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p>Specifies the maxScan option.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.maxScan(100)
</pre></div>


<p><strong>注释</strong></p>
<p>Cannot be used with <code>distinct()</code></p>
<h2 id="queryprototypebatchsize">Query.prototype.batchSize()<a class="headerlink" href="#queryprototypebatchsize" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p>Specifies the batchSize option.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.batchSize(100)
</pre></div>


<p><strong>注释</strong></p>
<p>Cannot be used with <code>distinct()</code></p>
<p><strong>参数</strong></p>
<p>Specifies the <code>comment</code> option.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.comment(&#39;login query&#39;)
</pre></div>


<p><strong>注释</strong></p>
<p>Cannot be used with <code>distinct()</code></p>
<h2 id="queryprototypesnapshot">Query.prototype.snapshot()<a class="headerlink" href="#queryprototypesnapshot" title="Permanent link">&para;</a></h2>
<p><strong>返回</strong></p>
<p>Specifies this query as a <code>snapshot</code> query.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.snapshot()
query.snapshot(true)
query.snapshot(false)
</pre></div>


<p><strong>注释</strong></p>
<p>Cannot be used with <code>distinct()</code></p>
<h2 id="queryprototypehint">Query.prototype.hint()<a class="headerlink" href="#queryprototypehint" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>val «Object» a hint object</li>
</ul>
<p><strong>返回</strong></p>
<p>Sets query hints.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.hint({ indexA: 1, indexB: -1})
</pre></div>


<p><strong>注释</strong></p>
<p>Cannot be used with <code>distinct()</code></p>
<h2 id="queryprototypeselect">Query.prototype.select()<a class="headerlink" href="#queryprototypeselect" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Specifies which document fields to include or exclude (also known as the query "projection")</p>
<p>When using string syntax, prefixing a path with <code>-</code> will flag that path as excluded. When a path does not have the <code>-</code> prefix, it is included. Lastly, if a path is prefixed with <code>+</code>, it forces inclusion of the path, which is useful for paths excluded at the [schema level.</p>
<p>A projection <em>must</em> be either inclusive or exclusive. In other words, you must either list the fields to include (which excludes all others), or list the fields to exclude (which implies all other fields are included). The [<code>_id</code> field is the only exception because MongoDB includes it by default.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><span class="nt">query</span><span class="p">.</span><span class="nc">select</span><span class="o">(</span><span class="s1">&#39;a b&#39;</span><span class="o">);</span>

<span class="nt">query</span><span class="p">.</span><span class="nc">select</span><span class="o">(</span><span class="s1">&#39;-c -d&#39;</span><span class="o">);</span>

<span class="nt">query</span><span class="p">.</span><span class="nc">select</span><span class="o">(</span><span class="p">{</span> <span class="n">a</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">:</span> <span class="mi">1</span> <span class="p">}</span><span class="o">);</span>
<span class="nt">query</span><span class="p">.</span><span class="nc">select</span><span class="o">(</span><span class="p">{</span> <span class="n">c</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="o">:</span> <span class="mi">0</span> <span class="p">}</span><span class="o">);</span>

<span class="nt">query</span><span class="p">.</span><span class="nc">select</span><span class="o">(</span><span class="s1">&#39;+path&#39;</span><span class="o">)</span>
</pre></div>


<h2 id="queryprototypeslaveok">Query.prototype.slaveOk()<a class="headerlink" href="#queryprototypeslaveok" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>v «Boolean» defaults to true</li>
</ul>
<p><strong>返回</strong></p>
<p><em>DEPRECATED</em> Sets the slaveOk option.</p>
<p><strong>Deprecated</strong> in MongoDB 2.2 in favor of [read preferences.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.slaveOk()
query.slaveOk(true)
query.slaveOk(false)
</pre></div>


<h2 id="queryprototyperead">Query.prototype.read()<a class="headerlink" href="#queryprototyperead" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[tags] «Array» optional tags for this query</li>
</ul>
<p><strong>返回</strong></p>
<p>Determines the MongoDB nodes from which to read.</p>
<p><strong>喜好</strong></p>
<div class="codehilite"><pre><span></span>primary - (default) Read from primary only. Operations will produce an error if primary is unavailable. Cannot be combined with tags.
secondary            Read from secondary if available, otherwise error.
primaryPreferred     Read from primary if available, otherwise a secondary.
secondaryPreferred   Read from a secondary if available, otherwise read from the primary.
nearest              All operations read from among the nearest candidates, but unlike other modes, this option will include both the primary and all secondaries in the random selection.
</pre></div>


<p><strong>别名</strong></p>
<div class="codehilite"><pre><span></span>p   primary
pp  primaryPreferred
s   secondary
sp  secondaryPreferred
n   nearest
</pre></div>


<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>new Query().read(&#39;primary&#39;)
new Query().read(&#39;p&#39;)

new Query().read(&#39;primaryPreferred&#39;)
new Query().read(&#39;pp&#39;)

new Query().read(&#39;secondary&#39;)
new Query().read(&#39;s&#39;)

new Query().read(&#39;secondaryPreferred&#39;)
new Query().read(&#39;sp&#39;)

new Query().read(&#39;nearest&#39;)
new Query().read(&#39;n&#39;)

new Query().read(&#39;s&#39;, [{ dc:&#39;sf&#39;, s: 1 },{ dc:&#39;ma&#39;, s: 2 }])
</pre></div>


<p>Read more about how to use read preferrences [here and [here.</p>
<h2 id="queryprototypemerge">Query.prototype.merge()<a class="headerlink" href="#queryprototypemerge" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Merges another Query or conditions object into this one.</p>
<p>When a Query is passed, conditions, field selection and options are merged.</p>
<p>New in 3.7.0</p>
<h2 id="queryprototypesetoptions">Query.prototype.setOptions()<a class="headerlink" href="#queryprototypesetoptions" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p>Sets query options. Some options only make sense for certain operations.</p>
<p><strong>选项</strong></p>
<p>The following options are only for <code>find()</code>: - [tailable - [sort - [limit - [skip - [maxscan - [batchSize - [comment - [snapshot - [readPreference - [hint</p>
<p>The following options are only for <code>update()</code>, <code>updateOne()</code>, <code>updateMany()</code>, <code>replaceOne()</code>, <code>findOneAndUpdate()</code>, and <code>findByIdAndUpdate()</code>: - [upsert - [writeConcern</p>
<p>The following options are only for <code>find()</code>, <code>findOne()</code>, <code>findById()</code>, <code>findOneAndUpdate()</code>, <code>findByIdAndUpdate()</code>, and <code>geoSearch()</code>: - [lean</p>
<p>The following options are for all operations</p>
<h2 id="queryprototypegetquery">Query.prototype.getQuery()<a class="headerlink" href="#queryprototypegetquery" title="Permanent link">&para;</a></h2>
<p><strong>返回</strong></p>
<ul>
<li>«Object» current query conditions</li>
</ul>
<p>Returns the current query conditions as a JSON object.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><span class="nt">var</span> <span class="nt">query</span> <span class="o">=</span> <span class="nt">new</span> <span class="nt">Query</span><span class="o">();</span>
<span class="nt">query</span><span class="p">.</span><span class="nc">find</span><span class="o">(</span><span class="p">{</span> <span class="n">a</span><span class="p">:</span> <span class="mi">1</span> <span class="p">}</span><span class="o">)</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;b&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">gt</span><span class="o">(</span><span class="nt">2</span><span class="o">);</span>
<span class="nt">query</span><span class="p">.</span><span class="nc">getQuery</span><span class="o">();</span>
</pre></div>


<h2 id="queryprototypegetupdate">Query.prototype.getUpdate()<a class="headerlink" href="#queryprototypegetupdate" title="Permanent link">&para;</a></h2>
<p><strong>返回</strong></p>
<ul>
<li>«Object» current update operations</li>
</ul>
<p>Returns the current update operations as a JSON object.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><span class="nt">var</span> <span class="nt">query</span> <span class="o">=</span> <span class="nt">new</span> <span class="nt">Query</span><span class="o">();</span>
<span class="nt">query</span><span class="p">.</span><span class="nc">update</span><span class="o">(</span><span class="p">{}</span><span class="o">,</span> <span class="p">{</span> <span class="err">$</span><span class="n">set</span><span class="p">:</span> <span class="err">{</span> <span class="n">a</span><span class="o">:</span> <span class="mi">5</span> <span class="p">}</span> <span class="err">}</span><span class="o">);</span>
<span class="nt">query</span><span class="p">.</span><span class="nc">getUpdate</span><span class="o">();</span>
</pre></div>


<h2 id="queryprototypelean">Query.prototype.lean()<a class="headerlink" href="#queryprototypelean" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>bool «Boolean,Object» defaults to true</li>
</ul>
<p><strong>返回</strong></p>
<p>Sets the lean option.</p>
<p>Documents returned from queries with the <code>lean</code> option enabled are plain javascript objects, not [MongooseDocuments. They have no <code>save</code> method, getters/setters or other Mongoose magic applied.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>new Query().lean()
new Query().lean(true)
new Query().lean(false)

Model.find().lean().exec(function (err, docs) {
  docs[0] instanceof mongoose.Document
});
</pre></div>


<p>This is a [great option in high-performance read-only scenarios, especially when combined with [stream.</p>
<h2 id="queryprototypeerror">Query.prototype.error()<a class="headerlink" href="#queryprototypeerror" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>err «Error,null» if set, <code>exec()</code> will fail fast before sending the query to MongoDB</li>
</ul>
<p>Gets/sets the error flag on this query. If this flag is not null or undefined, the <code>exec()</code> promise will reject without executing.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>Query().error();
Query().error(null);
Query().error(new Error(&#39;test&#39;));
Schema.pre(&#39;find&#39;, function() {
  if (!this.getQuery().userId) {
    this.error(new Error(&#39;Not allowed to query without setting userId&#39;));
  }
});
</pre></div>


<p>Note that query casting runs <strong>after</strong> hooks, so cast errors will override custom errors.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><span class="nt">var</span> <span class="nt">TestSchema</span> <span class="o">=</span> <span class="nt">new</span> <span class="nt">Schema</span><span class="o">(</span><span class="p">{</span> <span class="n">num</span><span class="p">:</span> <span class="n">Number</span> <span class="p">}</span><span class="o">);</span>
<span class="nt">var</span> <span class="nt">TestModel</span> <span class="o">=</span> <span class="nt">db</span><span class="p">.</span><span class="nc">model</span><span class="o">(</span><span class="s1">&#39;Test&#39;</span><span class="o">,</span> <span class="nt">TestSchema</span><span class="o">);</span>
<span class="nt">TestModel</span><span class="p">.</span><span class="nc">find</span><span class="o">(</span><span class="p">{</span> <span class="n">num</span><span class="p">:</span> <span class="s1">&#39;not a number&#39;</span> <span class="p">}</span><span class="o">)</span><span class="p">.</span><span class="nc">error</span><span class="o">(</span><span class="nt">new</span> <span class="nt">Error</span><span class="o">(</span><span class="s1">&#39;woops&#39;</span><span class="o">))</span><span class="p">.</span><span class="nc">exec</span><span class="o">(</span><span class="nt">function</span><span class="o">(</span><span class="nt">error</span><span class="o">)</span> <span class="p">{</span>

<span class="p">}</span><span class="o">);</span>
</pre></div>


<h2 id="queryprototypemongooseoptions">Query.prototype.mongooseOptions()<a class="headerlink" href="#queryprototypemongooseoptions" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>options «Object» if specified, overwrites the current options</li>
</ul>
<p>Getter/setter around the current mongoose-specific options for this query (populate, lean, etc.)</p>
<h2 id="queryprototypefind">Query.prototype.find()<a class="headerlink" href="#queryprototypefind" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Finds documents.</p>
<p>When no <code>callback</code> is passed, the query is not executed. When the query is executed, the result will be an array of documents.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.find({ name: &#39;Los Pollos Hermanos&#39; }).find(callback)
</pre></div>


<h2 id="queryprototypemerge_1">Query.prototype.merge()<a class="headerlink" href="#queryprototypemerge_1" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Merges another Query or conditions object into this one.</p>
<p>When a Query is passed, conditions, field selection and options are merged.</p>
<h2 id="queryprototypecollation">Query.prototype.collation()<a class="headerlink" href="#queryprototypecollation" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Adds a collation to this op (MongoDB 3.4 and up)</p>
<h2 id="queryprototypefindone">Query.prototype.findOne()<a class="headerlink" href="#queryprototypefindone" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» optional params are (error, document)</li>
</ul>
<p><strong>返回</strong></p>
<p>Declares the query a findOne operation. When executed, the first found document is passed to the callback.</p>
<p>Passing a <code>callback</code> executes the query. The result of the query is a single document.</p>
<ul>
<li><em>Note:</em> <code>conditions</code> is optional, and if <code>conditions</code> is null or undefined, mongoose will send an empty <code>findOne</code> command to MongoDB, which will return an arbitrary document. If you're querying by <code>_id</code>, use <code>Model.findById()</code> instead.</li>
</ul>
<p>This function triggers the following middleware.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><span class="nt">var</span> <span class="nt">query</span>  <span class="o">=</span> <span class="nt">Kitten</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="p">{</span> <span class="k">color</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span> <span class="p">}</span><span class="o">);</span>
<span class="nt">query</span><span class="p">.</span><span class="nc">findOne</span><span class="o">(</span><span class="nt">function</span> <span class="o">(</span><span class="nt">err</span><span class="o">,</span> <span class="nt">kitten</span><span class="o">)</span> <span class="p">{</span>
  <span class="err">if</span> <span class="err">(err)</span> <span class="err">return</span> <span class="err">handleError(err)</span><span class="p">;</span>
  <span class="err">if</span> <span class="err">(kitten)</span> <span class="err">{</span>

  <span class="p">}</span>
<span class="err">}</span><span class="o">);</span>
</pre></div>


<h2 id="queryprototypecount">Query.prototype.count()<a class="headerlink" href="#queryprototypecount" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» optional params are (error, count)</li>
</ul>
<p><strong>返回</strong></p>
<p>Specifying this query as a <code>count</code> query.</p>
<p>Passing a <code>callback</code> executes the query.</p>
<p>This function triggers the following middleware.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>var countQuery = model.where({ &#39;color&#39;: &#39;black&#39; }).count();

query.count({ color: &#39;black&#39; }).count(callback)

query.count({ color: &#39;black&#39; }, callback)

query.where(&#39;color&#39;, &#39;black&#39;).count(function (err, count) {
  if (err) return handleError(err);
  console.log(&#39;there are %d kittens&#39;, count);
})
</pre></div>


<h2 id="queryprototypedistinct">Query.prototype.distinct()<a class="headerlink" href="#queryprototypedistinct" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» optional params are (error, arr)</li>
</ul>
<p><strong>返回</strong></p>
<p>Declares or executes a distict() operation.</p>
<p>Passing a <code>callback</code> executes the query.</p>
<p>This function does not trigger any middleware.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>distinct(field, conditions, callback)
distinct(field, conditions)
distinct(field, callback)
distinct(field)
distinct(callback)
distinct()
</pre></div>


<h2 id="queryprototypesort">Query.prototype.sort()<a class="headerlink" href="#queryprototypesort" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Sets the sort order</p>
<p>If an object is passed, values allowed are <code>asc</code>, <code>desc</code>, <code>ascending</code>, <code>descending</code>, <code>1</code>, and <code>-1</code>.</p>
<p>If a string is passed, it must be a space delimited list of path names. The sort order of each path is ascending unless the path name is prefixed with <code>-</code> which will be treated as descending.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><span class="nt">query</span><span class="p">.</span><span class="nc">sort</span><span class="o">(</span><span class="p">{</span> <span class="n">field</span><span class="p">:</span> <span class="s1">&#39;asc&#39;</span><span class="p">,</span> <span class="n">test</span><span class="o">:</span> <span class="mi">-1</span> <span class="p">}</span><span class="o">);</span>

<span class="nt">query</span><span class="p">.</span><span class="nc">sort</span><span class="o">(</span><span class="s1">&#39;field -test&#39;</span><span class="o">);</span>
</pre></div>


<p><strong>注释</strong></p>
<p>Cannot be used with <code>distinct()</code></p>
<h2 id="queryprototyperemove">Query.prototype.remove()<a class="headerlink" href="#queryprototyperemove" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» optional params are (error, writeOpResult)</li>
</ul>
<p><strong>返回</strong></p>
<p>Declare and/or execute this query as a remove() operation.</p>
<p>This function does not trigger any middleware</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>Model.remove({ artist: &#39;Anne Murray&#39; }, callback)
</pre></div>


<p><strong>注释</strong></p>
<p>The operation is only executed when a callback is passed. To force execution without a callback, you must first call <code>remove()</code> and then execute it by using the <code>exec()</code> method.</p>
<div class="codehilite"><pre><span></span>var query = Model.find().remove({ name: &#39;Anne Murray&#39; })

query.remove({ name: &#39;Anne Murray&#39; }, callback)
query.remove({ name: &#39;Anne Murray&#39; }).remove(callback)

query.exec()

query.remove(conds, fn);
query.remove(conds)
query.remove(fn)
query.remove()
</pre></div>


<h2 id="queryprototypedeleteone">Query.prototype.deleteOne()<a class="headerlink" href="#queryprototypedeleteone" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» optional params are (error, writeOpResult)</li>
</ul>
<p><strong>返回</strong></p>
<p>Declare and/or execute this query as a <code>deleteOne()</code> operation. Works like remove, except it deletes at most one document regardless of the <code>single</code> option.</p>
<p>This function does not trigger any middleware.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>Character.deleteOne({ name: &#39;Eddard Stark&#39; }, callback)
Character.deleteOne({ name: &#39;Eddard Stark&#39; }).then(next)
</pre></div>


<h2 id="queryprototypedeletemany">Query.prototype.deleteMany()<a class="headerlink" href="#queryprototypedeletemany" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» optional params are (error, writeOpResult)</li>
</ul>
<p><strong>返回</strong></p>
<p>Declare and/or execute this query as a <code>deleteMany()</code> operation. Works like remove, except it deletes <em>every</em> document that matches <code>criteria</code> in the collection, regardless of the value of <code>single</code>.</p>
<p>This function does not trigger any middleware</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>Character.deleteMany({ name: /Stark/, age: { $gte: 18 } }, callback)
Character.deleteMany({ name: /Stark/, age: { $gte: 18 } }).then(next)
</pre></div>


<h2 id="queryprototypefindoneandupdate">Query.prototype.findOneAndUpdate()<a class="headerlink" href="#queryprototypefindoneandupdate" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» optional params are (error, doc), <em>unless</em> <code>rawResult</code> is used, in which case params are (error, writeOpResult)</li>
</ul>
<p><strong>返回</strong></p>
<p>Issues a mongodb [findAndModify update command.</p>
<p>Finds a matching document, updates it according to the <code>update</code> arg, passing any <code>options</code>, and returns the found document (if any) to the callback. The query executes immediately if <code>callback</code> is passed.</p>
<p>This function triggers the following middleware.</p>
<p><strong>选项</strong></p>
<ul>
<li><code>new</code>: bool - if true, return the modified document rather than the original. defaults to false (changed in 4.0)</li>
<li><code>upsert</code>: bool - creates the object if it doesn't exist. defaults to false.</li>
<li><code>fields</code>: {Object|String} - Field selection. Equivalent to <code>.select(fields).findOneAndUpdate()</code></li>
<li><code>sort</code>: if multiple docs are found by the conditions, sets the sort order to choose which doc to update</li>
<li><code>maxTimeMS</code>: puts a time limit on the query - requires mongodb &gt;= 2.6.0</li>
<li><code>runValidators</code>: if true, runs [update validators on this command. Update validators validate the update operation against the model's schema.</li>
<li><code>setDefaultsOnInsert</code>: if this and <code>upsert</code> are true, mongoose will apply the [defaults specified in the model's schema if a new document is created. This option only works on MongoDB &gt;= 2.4 because it relies on [MongoDB's <code>$setOnInsert</code> operator.</li>
<li><code>rawResult</code>: if true, returns the [raw result from the MongoDB driver</li>
<li><code>context</code> (string) if set to 'query' and <code>runValidators</code> is on, <code>this</code> will refer to the query in custom validator functions that update validation runs. Does nothing if <code>runValidators</code> is false.</li>
</ul>
<p><strong>回调签名</strong></p>
<div class="codehilite"><pre><span></span>function(error, doc) {

}
</pre></div>


<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.findOneAndUpdate(conditions, update, options, callback)
query.findOneAndUpdate(conditions, update, options)
query.findOneAndUpdate(conditions, update, callback)
query.findOneAndUpdate(conditions, update)
query.findOneAndUpdate(update, callback)
query.findOneAndUpdate(update)
query.findOneAndUpdate(callback)
query.findOneAndUpdate()
</pre></div>


<h2 id="queryprototypefindoneandremove">Query.prototype.findOneAndRemove()<a class="headerlink" href="#queryprototypefindoneandremove" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» optional params are (error, document)</li>
</ul>
<p><strong>返回</strong></p>
<p>Issues a mongodb [findAndModify remove command.</p>
<p>Finds a matching document, removes it, passing the found document (if any) to the callback. Executes immediately if <code>callback</code> is passed.</p>
<p>This function triggers the following middleware.</p>
<p><strong>选项</strong></p>
<ul>
<li><code>sort</code>: if multiple docs are found by the conditions, sets the sort order to choose which doc to update</li>
<li><code>maxTimeMS</code>: puts a time limit on the query - requires mongodb &gt;= 2.6.0</li>
<li><code>rawResult</code>: if true, resolves to the [raw result from the MongoDB driver</li>
</ul>
<p><strong>回调签名</strong></p>
<div class="codehilite"><pre><span></span>function(error, doc) {

}
</pre></div>


<p><strong>示例</strong>s</p>
<div class="codehilite"><pre><span></span>A.where().findOneAndRemove(conditions, options, callback)
A.where().findOneAndRemove(conditions, options)
A.where().findOneAndRemove(conditions, callback)
A.where().findOneAndRemove(conditions)
A.where().findOneAndRemove(callback)
A.where().findOneAndRemove()
</pre></div>


<h2 id="queryprototypeupdate">Query.prototype.update()<a class="headerlink" href="#queryprototypeupdate" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» optional, params are (error, writeOpResult)</li>
</ul>
<p><strong>返回</strong></p>
<p>Declare and/or execute this query as an update() operation.</p>
<p><em>All paths passed that are not $atomic operations will become $set ops.</em></p>
<p>This function triggers the following middleware.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>Model.where({ _id: id }).update({ title: &#39;words&#39; })

Model.where({ _id: id }).update({ $set: { title: &#39;words&#39; }})
</pre></div>


<p><strong>选项</strong></p>
<ul>
<li><code>safe</code> (boolean) safe mode (defaults to value set in schema (true))</li>
<li><code>upsert</code> (boolean) whether to create the doc if it doesn't match (false)</li>
<li><code>multi</code> (boolean) whether multiple documents should be updated (false)</li>
<li><code>runValidators</code>: if true, runs [update validators on this command. Update validators validate the update operation against the model's schema.</li>
<li><code>setDefaultsOnInsert</code>: if this and <code>upsert</code> are true, mongoose will apply the [defaults specified in the model's schema if a new document is created. This option only works on MongoDB &gt;= 2.4 because it relies on [MongoDB's <code>$setOnInsert</code> operator.</li>
<li><code>strict</code> (boolean) overrides the <code>strict</code> option for this update</li>
<li><code>overwrite</code> (boolean) disables update-only mode, allowing you to overwrite the doc (false)</li>
<li><code>context</code> (string) if set to 'query' and <code>runValidators</code> is on, <code>this</code> will refer to the query in custom validator functions that update validation runs. Does nothing if <code>runValidators</code> is false.</li>
</ul>
<p><strong>注释</strong></p>
<p>Passing an empty object <code>{}</code> as the doc will result in a no-op unless the <code>overwrite</code> option is passed. Without the <code>overwrite</code> option set, the update operation will be ignored and the callback executed without sending the command to MongoDB so as to prevent accidently overwritting documents in the collection.</p>
<p><strong>注释</strong></p>
<p>The operation is only executed when a callback is passed. To force execution without a callback, we must first call update() and then execute it by using the <code>exec()</code> method.</p>
<div class="codehilite"><pre><span></span><span class="nt">var</span> <span class="nt">q</span> <span class="o">=</span> <span class="nt">Model</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="p">{</span> <span class="n">_id</span><span class="p">:</span> <span class="n">id</span> <span class="p">}</span><span class="o">);</span>
<span class="nt">q</span><span class="p">.</span><span class="nc">update</span><span class="o">(</span><span class="p">{</span> <span class="err">$</span><span class="n">set</span><span class="p">:</span> <span class="err">{</span> <span class="n">name</span><span class="o">:</span> <span class="s1">&#39;bob&#39;</span> <span class="p">}</span><span class="err">}</span><span class="o">)</span><span class="p">.</span><span class="nc">update</span><span class="o">();</span> <span class="o">//</span> <span class="nt">not</span> <span class="nt">executed</span>

<span class="nt">q</span><span class="p">.</span><span class="nc">update</span><span class="o">(</span><span class="p">{</span> <span class="err">$</span><span class="n">set</span><span class="p">:</span> <span class="err">{</span> <span class="n">name</span><span class="o">:</span> <span class="s1">&#39;bob&#39;</span> <span class="p">}</span><span class="err">}</span><span class="o">)</span><span class="p">.</span><span class="nc">exec</span><span class="o">();</span> <span class="o">//</span> <span class="nt">executed</span>

<span class="o">//</span> <span class="nt">keys</span> <span class="nt">that</span> <span class="nt">are</span> <span class="nt">not</span> <span class="o">$</span><span class="nt">atomic</span> <span class="nt">ops</span> <span class="nt">become</span> <span class="o">$</span><span class="nt">set</span><span class="o">.</span>
<span class="o">//</span> <span class="nt">this</span> <span class="nt">executes</span> <span class="nt">the</span> <span class="nt">same</span> <span class="nt">command</span> <span class="nt">as</span> <span class="nt">the</span> <span class="nt">previous</span> <span class="nt">example</span><span class="o">.</span>
<span class="nt">q</span><span class="p">.</span><span class="nc">update</span><span class="o">(</span><span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;bob&#39;</span> <span class="p">}</span><span class="o">)</span><span class="p">.</span><span class="nc">exec</span><span class="o">();</span>

<span class="o">//</span> <span class="nt">overwriting</span> <span class="nt">with</span> <span class="nt">empty</span> <span class="nt">docs</span>
<span class="nt">var</span> <span class="nt">q</span> <span class="o">=</span> <span class="nt">Model</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="p">{</span> <span class="n">_id</span><span class="p">:</span> <span class="n">id</span> <span class="p">}</span><span class="o">)</span><span class="p">.</span><span class="nc">setOptions</span><span class="o">(</span><span class="p">{</span> <span class="n">overwrite</span><span class="p">:</span> <span class="n">true</span> <span class="p">}</span><span class="o">)</span>
<span class="nt">q</span><span class="p">.</span><span class="nc">update</span><span class="o">(</span><span class="p">{</span> <span class="p">}</span><span class="o">,</span> <span class="nt">callback</span><span class="o">);</span> <span class="o">//</span> <span class="nt">executes</span>

<span class="o">//</span> <span class="nt">multi</span> <span class="nt">update</span> <span class="nt">with</span> <span class="nt">overwrite</span> <span class="nt">to</span> <span class="nt">empty</span> <span class="nt">doc</span>
<span class="nt">var</span> <span class="nt">q</span> <span class="o">=</span> <span class="nt">Model</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="p">{</span> <span class="n">_id</span><span class="p">:</span> <span class="n">id</span> <span class="p">}</span><span class="o">);</span>
<span class="nt">q</span><span class="p">.</span><span class="nc">setOptions</span><span class="o">(</span><span class="p">{</span> <span class="n">multi</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">:</span> <span class="n">true</span> <span class="p">}</span><span class="o">)</span>
<span class="nt">q</span><span class="p">.</span><span class="nc">update</span><span class="o">(</span><span class="p">{</span> <span class="p">}</span><span class="o">);</span>
<span class="nt">q</span><span class="p">.</span><span class="nc">update</span><span class="o">(</span><span class="nt">callback</span><span class="o">);</span> <span class="o">//</span> <span class="nt">executed</span>

<span class="o">//</span> <span class="nt">multi</span> <span class="nt">updates</span>
<span class="nt">Model</span><span class="p">.</span><span class="nc">where</span><span class="o">()</span>
     <span class="p">.</span><span class="nc">update</span><span class="o">(</span><span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="o">/^</span><span class="n">match</span><span class="o">/</span> <span class="p">}</span><span class="o">,</span> <span class="p">{</span> <span class="err">$</span><span class="n">set</span><span class="p">:</span> <span class="err">{</span> <span class="n">arr</span><span class="o">:</span> <span class="cp">[]</span> <span class="p">}</span><span class="err">}</span><span class="o">,</span> <span class="p">{</span> <span class="n">multi</span><span class="p">:</span> <span class="n">true</span> <span class="p">}</span><span class="o">,</span> <span class="nt">callback</span><span class="o">)</span>

<span class="o">//</span> <span class="nt">more</span> <span class="nt">multi</span> <span class="nt">updates</span>
<span class="nt">Model</span><span class="p">.</span><span class="nc">where</span><span class="o">()</span>
     <span class="p">.</span><span class="nc">setOptions</span><span class="o">(</span><span class="p">{</span> <span class="n">multi</span><span class="p">:</span> <span class="n">true</span> <span class="p">}</span><span class="o">)</span>
     <span class="p">.</span><span class="nc">update</span><span class="o">(</span><span class="p">{</span> <span class="err">$</span><span class="n">set</span><span class="p">:</span> <span class="err">{</span> <span class="n">arr</span><span class="o">:</span> <span class="cp">[]</span> <span class="p">}</span><span class="err">}</span><span class="o">,</span> <span class="nt">callback</span><span class="o">)</span>

<span class="o">//</span> <span class="nt">single</span> <span class="nt">update</span> <span class="nt">by</span> <span class="nt">default</span>
<span class="nt">Model</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="p">{</span> <span class="n">email</span><span class="p">:</span> <span class="err">&#39;</span><span class="cp">[</span><span class="nx">address</span><span class="p">@</span><span class="nx">example.com</span><span class="s1">&#39; })</span>
<span class="s1">     .update({ $inc: { counter: 1 }}, callback)</span>
</pre></div>


<p>API summary</p>
<div class="codehilite"><pre><span></span>update(criteria, doc, options, cb)
update(criteria, doc, options)
update(criteria, doc, cb)
update(criteria, doc)
update(doc, cb)
update(doc)
update(cb)
update(true)
update()
</pre></div>


<h2 id="queryprototypeupdatemany">Query.prototype.updateMany()<a class="headerlink" href="#queryprototypeupdatemany" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» optional params are (error, writeOpResult)</li>
</ul>
<p><strong>返回</strong></p>
<p>Declare and/or execute this query as an updateMany() operation. Same as <code>update()</code>, except MongoDB will update <em>all</em> documents that match <code>criteria</code> (as opposed to just the first one) regardless of the value of the <code>multi</code> option.</p>
<p><strong>Note</strong> updateMany will <em>not</em> fire update middleware. Use <code>pre('updateMany')</code> and <code>post('updateMany')</code> instead.</p>
<p>This function triggers the following middleware.</p>
<h2 id="queryprototypeupdateone">Query.prototype.updateOne()<a class="headerlink" href="#queryprototypeupdateone" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» params are (error, writeOpResult)</li>
</ul>
<p><strong>返回</strong></p>
<p>Declare and/or execute this query as an updateOne() operation. Same as <code>update()</code>, except MongoDB will update <em>only</em> the first document that matches <code>criteria</code> regardless of the value of the <code>multi</code> option.</p>
<p><strong>Note</strong> updateOne will <em>not</em> fire update middleware. Use <code>pre('updateOne')</code> and <code>post('updateOne')</code> instead.</p>
<p>This function triggers the following middleware.</p>
<h2 id="queryprototypereplaceone">Query.prototype.replaceOne()<a class="headerlink" href="#queryprototypereplaceone" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» optional params are (error, writeOpResult)</li>
</ul>
<p><strong>返回</strong></p>
<p>Declare and/or execute this query as a replaceOne() operation. Same as <code>update()</code>, except MongoDB will replace the existing document and will not accept any atomic operators (<code>$set</code>, etc.)</p>
<p><strong>Note</strong> replaceOne will <em>not</em> fire update middleware. Use <code>pre('replaceOne')</code> and <code>post('replaceOne')</code> instead.</p>
<p>This function triggers the following middleware.</p>
<h2 id="queryprototypeexec">Query.prototype.exec()<a class="headerlink" href="#queryprototypeexec" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» optional params depend on the function being called</li>
</ul>
<p><strong>返回</strong></p>
<p>Executes the query</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>var promise = query.exec();
var promise = query.exec(&#39;update&#39;);

query.exec(callback);
query.exec(&#39;find&#39;, callback);
</pre></div>


<h2 id="queryprototypethen">Query.prototype.then()<a class="headerlink" href="#queryprototypethen" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Executes the query returning a <code>Promise</code> which will be resolved with either the doc(s) or rejected with the error.</p>
<h2 id="queryprototypecatch">Query.prototype.catch()<a class="headerlink" href="#queryprototypecatch" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Executes the query returning a <code>Promise</code> which will be resolved with either the doc(s) or rejected with the error. Like <code>.then()</code>, but only takes a rejection handler.</p>
<h2 id="queryprototypepopulate">Query.prototype.populate()<a class="headerlink" href="#queryprototypepopulate" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[options] «Object» Options for the population query (sort, etc)</li>
</ul>
<p><strong>返回</strong></p>
<p>Specifies paths which should be populated with other documents.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>Kitten.findOne().populate(&#39;owner&#39;).exec(function (err, kitten) {
  console.log(kitten.owner.name)
})

Kitten.find().populate({
    path: &#39;owner&#39;
  , select: &#39;name&#39;
  , match: { color: &#39;black&#39; }
  , options: { sort: { name: -1 }}
}).exec(function (err, kittens) {
  console.log(kittens[0].owner.name)
})

Kitten.find().populate(&#39;owner&#39;, &#39;name&#39;, null, {sort: { name: -1 }}).exec(function (err, kittens) {
  console.log(kittens[0].owner.name)
})
</pre></div>


<p>Paths are populated after the query executes and a response is received. A separate query is then executed for each path specified for population. After a response for each query has also been returned, the results are passed to the callback.</p>
<h2 id="queryprototypecast">Query.prototype.cast()<a class="headerlink" href="#queryprototypecast" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Casts this query to the schema of <code>model</code></p>
<p><strong>注释</strong></p>
<p>If <code>obj</code> is present, it is cast instead of this query.</p>
<h2 id="queryprototypecursor">Query.prototype.cursor()<a class="headerlink" href="#queryprototypecursor" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Returns a wrapper around a [mongodb driver cursor. A QueryCursor exposes a [Streams3-compatible interface, as well as a <code>.next()</code> function.</p>
<p>The <code>.cursor()</code> function triggers pre find hooks, but <strong>not</strong> post find hooks.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><span class="nt">Thing</span><span class="o">.</span>
  <span class="nt">find</span><span class="o">(</span><span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="o">/^</span><span class="n">hello</span><span class="o">/</span> <span class="p">}</span><span class="o">).</span>
  <span class="nt">cursor</span><span class="o">().</span>
  <span class="nt">on</span><span class="o">(</span><span class="s1">&#39;data&#39;</span><span class="o">,</span> <span class="nt">function</span><span class="o">(</span><span class="nt">doc</span><span class="o">)</span> <span class="p">{</span> <span class="err">console.log(doc)</span><span class="p">;</span> <span class="p">}</span><span class="o">).</span>
  <span class="nt">on</span><span class="o">(</span><span class="s1">&#39;end&#39;</span><span class="o">,</span> <span class="nt">function</span><span class="o">()</span> <span class="p">{</span> <span class="err">console.log(&#39;Done!&#39;)</span><span class="p">;</span> <span class="p">}</span><span class="o">);</span>

<span class="nt">var</span> <span class="nt">cursor</span> <span class="o">=</span> <span class="nt">Thing</span><span class="p">.</span><span class="nc">find</span><span class="o">(</span><span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="o">/^</span><span class="n">hello</span><span class="o">/</span> <span class="p">}</span><span class="o">)</span><span class="p">.</span><span class="nc">cursor</span><span class="o">();</span>
<span class="nt">cursor</span><span class="p">.</span><span class="nc">next</span><span class="o">(</span><span class="nt">function</span><span class="o">(</span><span class="nt">error</span><span class="o">,</span> <span class="nt">doc</span><span class="o">)</span> <span class="p">{</span>
  <span class="err">console.log(doc)</span><span class="p">;</span>
<span class="p">}</span><span class="o">);</span>

<span class="nt">co</span><span class="o">(</span><span class="nt">function</span><span class="o">*()</span> <span class="p">{</span>
  <span class="err">const</span> <span class="err">cursor</span> <span class="err">=</span> <span class="err">Thing.find({</span> <span class="n">name</span><span class="p">:</span> <span class="o">/^</span><span class="n">hello</span><span class="o">/</span> <span class="p">}</span><span class="o">)</span><span class="p">.</span><span class="nc">cursor</span><span class="o">();</span>
  <span class="nt">for</span> <span class="o">(</span><span class="nt">let</span> <span class="nt">doc</span> <span class="o">=</span> <span class="nt">yield</span> <span class="nt">cursor</span><span class="p">.</span><span class="nc">next</span><span class="o">();</span> <span class="nt">doc</span> <span class="o">!=</span> <span class="nt">null</span><span class="o">;</span> <span class="nt">doc</span> <span class="o">=</span> <span class="nt">yield</span> <span class="nt">cursor</span><span class="p">.</span><span class="nc">next</span><span class="o">())</span> <span class="p">{</span>
    <span class="err">console.log(doc)</span><span class="p">;</span>
  <span class="p">}</span>
<span class="err">}</span><span class="o">);</span>
</pre></div>


<p><strong>选项</strong></p>
<ul>
<li><code>transform</code>: optional function which accepts a mongoose document. The return value of the function will be emitted on <code>data</code> and returned by <code>.next()</code>.</li>
</ul>
<hr />
<h2 id="queryprototypemaxscan_1">Query.prototype.maxscan()<a class="headerlink" href="#queryprototypemaxscan_1" title="Permanent link">&para;</a></h2>
<p><em>DEPRECATED</em> Alias of <code>maxScan</code></p>
<h2 id="queryprototypetailable">Query.prototype.tailable()<a class="headerlink" href="#queryprototypetailable" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[opts.tailableRetryInterval] «Number» if cursor is exhausted, wait this many milliseconds before retrying</li>
</ul>
<p>Sets the tailable option (for use with capped collections).</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.tailable()
query.tailable(true)
query.tailable(false)
</pre></div>


<p><strong>注释</strong></p>
<p>Cannot be used with <code>distinct()</code></p>
<h2 id="queryprototypeintersects">Query.prototype.intersects()<a class="headerlink" href="#queryprototypeintersects" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Declares an intersects query for <code>geometry()</code>.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.where(&#39;path&#39;).intersects().geometry({
    type: &#39;LineString&#39;
  , coordinates: [[180.0, 11.0], [180, 9.0]]
})

query.where(&#39;path&#39;).intersects({
    type: &#39;LineString&#39;
  , coordinates: [[180.0, 11.0], [180, 9.0]]
})
</pre></div>


<p><strong>注释</strong></p>
<p><strong>MUST</strong> be used after <code>where()</code>.</p>
<p><strong>注释</strong></p>
<p>In Mongoose 3.7, <code>intersects</code> changed from a getter to a function. If you need the old syntax, use [this.</p>
<h2 id="queryprototypegeometry">Query.prototype.geometry()<a class="headerlink" href="#queryprototypegeometry" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>object «Object» Must contain a <code>type</code> property which is a String and a <code>coordinates</code> property which is an Array. See the examples.</li>
</ul>
<p><strong>返回</strong></p>
<p>Specifies a <code>$geometry</code> condition</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>var polyA = [[[ 10, 20 ], [ 10, 40 ], [ 30, 40 ], [ 30, 20 ]]]
query.where(&#39;loc&#39;).within().geometry({ type: &#39;Polygon&#39;, coordinates: polyA })

var polyB = [[ 0, 0 ], [ 1, 1 ]]
query.where(&#39;loc&#39;).within().geometry({ type: &#39;LineString&#39;, coordinates: polyB })

var polyC = [ 0, 0 ]
query.where(&#39;loc&#39;).within().geometry({ type: &#39;Point&#39;, coordinates: polyC })

query.where(&#39;loc&#39;).intersects().geometry({ type: &#39;Point&#39;, coordinates: polyC })
</pre></div>


<p>The argument is assigned to the most recent path passed to <code>where()</code>.</p>
<p><strong>注释</strong></p>
<p><code>geometry()</code> <strong>must</strong> come after either <code>intersects()</code> or <code>within()</code>.</p>
<p>The <code>object</code> argument must contain <code>type</code> and <code>coordinates</code> properties. - type {String} - coordinates {Array}</p>
<hr />
<h2 id="queryprototypenear">Query.prototype.near()<a class="headerlink" href="#queryprototypenear" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Specifies a <code>$near</code> or <code>$nearSphere</code> condition</p>
<p>These operators return documents sorted by distance.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><span class="nt">query</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;loc&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">near</span><span class="o">(</span><span class="p">{</span> <span class="n">center</span><span class="p">:</span> <span class="cp">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="cp">]</span> <span class="p">}</span><span class="o">);</span>
<span class="nt">query</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;loc&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">near</span><span class="o">(</span><span class="p">{</span> <span class="n">center</span><span class="p">:</span> <span class="cp">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="cp">]</span><span class="p">,</span> <span class="n">maxDistance</span><span class="o">:</span> <span class="mi">5</span> <span class="p">}</span><span class="o">);</span>
<span class="nt">query</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;loc&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">near</span><span class="o">(</span><span class="p">{</span> <span class="n">center</span><span class="p">:</span> <span class="cp">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="cp">]</span><span class="p">,</span> <span class="n">maxDistance</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span> <span class="n">spherical</span><span class="o">:</span> <span class="n">true</span> <span class="p">}</span><span class="o">);</span>
<span class="nt">query</span><span class="p">.</span><span class="nc">near</span><span class="o">(</span><span class="s1">&#39;loc&#39;</span><span class="o">,</span> <span class="p">{</span> <span class="n">center</span><span class="p">:</span> <span class="cp">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="cp">]</span><span class="p">,</span> <span class="n">maxDistance</span><span class="o">:</span> <span class="mi">5</span> <span class="p">}</span><span class="o">);</span>
</pre></div>


<h2 id="queryprototypenearsphere">Query.prototype.nearSphere()<a class="headerlink" href="#queryprototypenearsphere" title="Permanent link">&para;</a></h2>
<p><em>DEPRECATED</em> Specifies a <code>$nearSphere</code> condition</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><span class="nt">query</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;loc&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">nearSphere</span><span class="o">(</span><span class="p">{</span> <span class="n">center</span><span class="p">:</span> <span class="cp">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="cp">]</span><span class="p">,</span> <span class="n">maxDistance</span><span class="o">:</span> <span class="mi">5</span> <span class="p">}</span><span class="o">);</span>
</pre></div>


<p><strong>Deprecated.</strong> Use <code>query.near()</code> instead with the <code>spherical</code> option set to <code>true</code>.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><span class="nt">query</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;loc&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">near</span><span class="o">(</span><span class="p">{</span> <span class="n">center</span><span class="p">:</span> <span class="cp">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="cp">]</span><span class="p">,</span> <span class="n">spherical</span><span class="o">:</span> <span class="n">true</span> <span class="p">}</span><span class="o">);</span>
</pre></div>


<h2 id="queryprototypepolygon">Query.prototype.polygon()<a class="headerlink" href="#queryprototypepolygon" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[coordinatePairs...] «Array,Object»</li>
</ul>
<p><strong>返回</strong></p>
<p>Specifies a $polygon condition</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>query.where(&#39;loc&#39;).within().polygon([10,20], [13, 25], [7,15])
query.polygon(&#39;loc&#39;, [10,20], [13, 25], [7,15])
</pre></div>


<h2 id="queryprototypebox">Query.prototype.box()<a class="headerlink" href="#queryprototypebox" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>Upper «[Array]» Right Coords</li>
</ul>
<p><strong>返回</strong></p>
<p>Specifies a $box condition</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>var lowerLeft = [40.73083, -73.99756]
var upperRight= [40.741404,  -73.988135]

query.where(&#39;loc&#39;).within().box(lowerLeft, upperRight)
query.box({ ll : lowerLeft, ur : upperRight })
</pre></div>


<h2 id="queryprototypecircle">Query.prototype.circle()<a class="headerlink" href="#queryprototypecircle" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Specifies a $center or $centerSphere condition.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span>var area = { center: [50, 50], radius: 10, unique: true }
query.where(&#39;loc&#39;).within().circle(area)

query.circle(&#39;loc&#39;, area);

var area = { center: [50, 50], radius: 10, unique: true, spherical: true }
query.where(&#39;loc&#39;).within().circle(area)

query.circle(&#39;loc&#39;, area);
</pre></div>


<p>New in 3.7.0</p>
<h2 id="queryprototypecenter">Query.prototype.center()<a class="headerlink" href="#queryprototypecenter" title="Permanent link">&para;</a></h2>
<h2 id="queryprototypecentersphere">Query.prototype.centerSphere()<a class="headerlink" href="#queryprototypecentersphere" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p><em>DEPRECATED</em> Specifies a $centerSphere condition</p>
<p><strong>Deprecated.</strong> Use [circle instead.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><span class="nt">var</span> <span class="nt">area</span> <span class="o">=</span> <span class="p">{</span> <span class="n">center</span><span class="p">:</span> <span class="cp">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="cp">]</span><span class="p">,</span> <span class="n">radius</span><span class="o">:</span> <span class="mi">10</span> <span class="p">}</span><span class="o">;</span>
<span class="nt">query</span><span class="p">.</span><span class="nc">where</span><span class="o">(</span><span class="s1">&#39;loc&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">within</span><span class="o">()</span><span class="p">.</span><span class="nc">centerSphere</span><span class="o">(</span><span class="nt">area</span><span class="o">);</span>
</pre></div>


<h2 id="queryprototypeselected">Query.prototype.selected()<a class="headerlink" href="#queryprototypeselected" title="Permanent link">&para;</a></h2>
<p><strong>返回</strong></p>
<p>Determines if field selection has been made.</p>
<h2 id="queryprototypeselectedinclusively">Query.prototype.selectedInclusively()<a class="headerlink" href="#queryprototypeselectedinclusively" title="Permanent link">&para;</a></h2>
<p><strong>返回</strong></p>
<p>Determines if inclusive field selection has been made.</p>
<div class="codehilite"><pre><span></span>query.selectedInclusively()
query.select(&#39;name&#39;)
query.selectedInclusively()
</pre></div>


<h2 id="queryprototypeselectedexclusively">Query.prototype.selectedExclusively()<a class="headerlink" href="#queryprototypeselectedexclusively" title="Permanent link">&para;</a></h2>
<p><strong>返回</strong></p>
<p>Determines if exclusive field selection has been made.</p>
<div class="codehilite"><pre><span></span>query.selectedExclusively()
query.select(&#39;-name&#39;)
query.selectedExclusively()
query.selectedInclusively()
</pre></div>


<hr />
<hr />
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../guide/" title="指南" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  后退
                </span>
                指南
              </span>
            </div>
          </a>
        
        
          <a href="../../guide/Validation/" title="验证" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  前进
                </span>
                验证
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            版权 &copy; 2018 -  wohugb.github.io
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="http://wohugb.github.io" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/wohugb" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/wohugb" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://linkedin.com/in/wohugb" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.6cdc17f0.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              <script src="../../assets/javascripts/lunr/lunr.zh.js"></script>
            
          
          
        
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>