
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Mongodb NodeJs 组件中文文档">
      
      
      
        <meta name="author" content="Nosy">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.2">
    
    
      
        <title>模型API - Mongoose文档</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.24c991ad.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Mongoose文档" class="md-header__button md-logo" aria-label="Mongoose文档" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mongoose文档
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              模型API
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/wdk-docs/mongoose-docs" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    wdk-docs/mongoose-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Mongoose文档" class="md-nav__button md-logo" aria-label="Mongoose文档" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Mongoose文档
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/wdk-docs/mongoose-docs" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    wdk-docs/mongoose-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        前言
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../QuickStart/" class="md-nav__link">
        快速开始
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          连接
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="连接" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          连接
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../connection/guide/" class="md-nav__link">
        连接手册
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../connection/api/" class="md-nav__link">
        连接API
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          模式
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="模式" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          模式
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../schema/guide/" class="md-nav__link">
        模式手册
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../schema/api/" class="md-nav__link">
        模式API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../schema/type/" class="md-nav__link">
        模式类型API
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          模型
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="模型" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          模型
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../guide/" class="md-nav__link">
        模型手册
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          模型API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        模型API
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#model" class="md-nav__link">
    Model()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypedb" class="md-nav__link">
    Model.prototype.db
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypecollection" class="md-nav__link">
    Model.prototype.collection
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypemodelname" class="md-nav__link">
    Model.prototype.modelName
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypewhere" class="md-nav__link">
    Model.prototype.$where
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypebasemodelname" class="md-nav__link">
    Model.prototype.baseModelName
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypesave" class="md-nav__link">
    Model.prototype.save()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypeincrement" class="md-nav__link">
    Model.prototype.increment()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototyperemove" class="md-nav__link">
    Model.prototype.remove()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypemodel" class="md-nav__link">
    Model.prototype.model()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modeldiscriminator" class="md-nav__link">
    Model.discriminator()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelinit" class="md-nav__link">
    Model.init()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelensureindexes" class="md-nav__link">
    Model.ensureIndexes()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelcreateindexes" class="md-nav__link">
    Model.createIndexes()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypeschema" class="md-nav__link">
    Model.prototype.schema
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypebase" class="md-nav__link">
    Model.prototype.base
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypediscriminators" class="md-nav__link">
    Model.prototype.discriminators
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modeltranslatealiases" class="md-nav__link">
    Model.translateAliases()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelremove" class="md-nav__link">
    Model.remove()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modeldeleteone" class="md-nav__link">
    Model.deleteOne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modeldeletemany" class="md-nav__link">
    Model.deleteMany()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelfind" class="md-nav__link">
    Model.find()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelfindbyid" class="md-nav__link">
    Model.findById()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelfindone" class="md-nav__link">
    Model.findOne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelcount" class="md-nav__link">
    Model.count()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modeldistinct" class="md-nav__link">
    Model.distinct()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelwhere" class="md-nav__link">
    Model.where()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypewhere_1" class="md-nav__link">
    Model.prototype.$where()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelfindoneandupdate" class="md-nav__link">
    Model.findOneAndUpdate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelfindbyidandupdate" class="md-nav__link">
    Model.findByIdAndUpdate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelfindoneandremove" class="md-nav__link">
    Model.findOneAndRemove()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelfindbyidandremove" class="md-nav__link">
    Model.findByIdAndRemove()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelcreate" class="md-nav__link">
    Model.create()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelwatch" class="md-nav__link">
    Model.watch()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelinsertmany" class="md-nav__link">
    Model.insertMany()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelbulkwrite" class="md-nav__link">
    Model.bulkWrite()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelhydrate" class="md-nav__link">
    Model.hydrate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelupdate" class="md-nav__link">
    Model.update()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelupdatemany" class="md-nav__link">
    Model.updateMany()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelupdateone" class="md-nav__link">
    Model.updateOne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelreplaceone" class="md-nav__link">
    Model.replaceOne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelmapreduce" class="md-nav__link">
    Model.mapReduce()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelaggregate" class="md-nav__link">
    Model.aggregate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelgeosearch" class="md-nav__link">
    Model.geoSearch()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelpopulate" class="md-nav__link">
    Model.populate()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          文档
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="文档" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          文档
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../document/guide/" class="md-nav__link">
        文档手册
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../document/api/" class="md-nav__link">
        文档API
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          查询
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="查询" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          查询
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../query/guide/" class="md-nav__link">
        查询手册
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../query/api/" class="md-nav__link">
        查询API
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          其它手册
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="其它手册" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          其它手册
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/Validation/" class="md-nav__link">
        验证
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/Middleware/" class="md-nav__link">
        中间件
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/Populate/" class="md-nav__link">
        填充
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/Discriminators/" class="md-nav__link">
        鉴别器
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/Plugins/" class="md-nav__link">
        插件
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          其它API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="其它API" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          其它API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Aggregate/" class="md-nav__link">
        聚合
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/VirtualType/" class="md-nav__link">
        虚拟类型
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Error/" class="md-nav__link">
        错误
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../migrating_to_5/" class="md-nav__link">
        升级到5
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../VersionCompatibility/" class="md-nav__link">
        版本兼容性
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../FAQ/" class="md-nav__link">
        常问问题
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13" type="checkbox" id="__nav_13" >
      
      
      
      
        <label class="md-nav__link" for="__nav_13">
          驱动
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="驱动" data-md-level="1">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          驱动
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MongoDB_NodeJS_Driver/unified-topology/" class="md-nav__link">
        unified-topology
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#model" class="md-nav__link">
    Model()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypedb" class="md-nav__link">
    Model.prototype.db
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypecollection" class="md-nav__link">
    Model.prototype.collection
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypemodelname" class="md-nav__link">
    Model.prototype.modelName
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypewhere" class="md-nav__link">
    Model.prototype.$where
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypebasemodelname" class="md-nav__link">
    Model.prototype.baseModelName
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypesave" class="md-nav__link">
    Model.prototype.save()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypeincrement" class="md-nav__link">
    Model.prototype.increment()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototyperemove" class="md-nav__link">
    Model.prototype.remove()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypemodel" class="md-nav__link">
    Model.prototype.model()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modeldiscriminator" class="md-nav__link">
    Model.discriminator()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelinit" class="md-nav__link">
    Model.init()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelensureindexes" class="md-nav__link">
    Model.ensureIndexes()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelcreateindexes" class="md-nav__link">
    Model.createIndexes()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypeschema" class="md-nav__link">
    Model.prototype.schema
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypebase" class="md-nav__link">
    Model.prototype.base
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypediscriminators" class="md-nav__link">
    Model.prototype.discriminators
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modeltranslatealiases" class="md-nav__link">
    Model.translateAliases()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelremove" class="md-nav__link">
    Model.remove()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modeldeleteone" class="md-nav__link">
    Model.deleteOne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modeldeletemany" class="md-nav__link">
    Model.deleteMany()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelfind" class="md-nav__link">
    Model.find()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelfindbyid" class="md-nav__link">
    Model.findById()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelfindone" class="md-nav__link">
    Model.findOne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelcount" class="md-nav__link">
    Model.count()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modeldistinct" class="md-nav__link">
    Model.distinct()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelwhere" class="md-nav__link">
    Model.where()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelprototypewhere_1" class="md-nav__link">
    Model.prototype.$where()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelfindoneandupdate" class="md-nav__link">
    Model.findOneAndUpdate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelfindbyidandupdate" class="md-nav__link">
    Model.findByIdAndUpdate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelfindoneandremove" class="md-nav__link">
    Model.findOneAndRemove()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelfindbyidandremove" class="md-nav__link">
    Model.findByIdAndRemove()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelcreate" class="md-nav__link">
    Model.create()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelwatch" class="md-nav__link">
    Model.watch()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelinsertmany" class="md-nav__link">
    Model.insertMany()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelbulkwrite" class="md-nav__link">
    Model.bulkWrite()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelhydrate" class="md-nav__link">
    Model.hydrate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelupdate" class="md-nav__link">
    Model.update()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelupdatemany" class="md-nav__link">
    Model.updateMany()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelupdateone" class="md-nav__link">
    Model.updateOne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelreplaceone" class="md-nav__link">
    Model.replaceOne()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelmapreduce" class="md-nav__link">
    Model.mapReduce()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelaggregate" class="md-nav__link">
    Model.aggregate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelgeosearch" class="md-nav__link">
    Model.geoSearch()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelpopulate" class="md-nav__link">
    Model.populate()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="_1">模型<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="model">Model()<a class="headerlink" href="#model" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>doc «Object» values with which to create the document</li>
</ul>
<p>Model constructor</p>
<p>Provides the interface to MongoDB collections as well as creates document instances.</p>
<h2 id="modelprototypedb">Model.prototype.db<a class="headerlink" href="#modelprototypedb" title="Permanent link">&para;</a></h2>
<p>Connection the model uses.</p>
<h2 id="modelprototypecollection">Model.prototype.collection<a class="headerlink" href="#modelprototypecollection" title="Permanent link">&para;</a></h2>
<p>Collection the model uses.</p>
<h2 id="modelprototypemodelname">Model.prototype.modelName<a class="headerlink" href="#modelprototypemodelname" title="Permanent link">&para;</a></h2>
<h2 id="modelprototypewhere">Model.prototype.$where<a class="headerlink" href="#modelprototypewhere" title="Permanent link">&para;</a></h2>
<p>Additional properties to attach to the query when calling <code>save()</code> and <code>isNew</code> is false.</p>
<h2 id="modelprototypebasemodelname">Model.prototype.baseModelName<a class="headerlink" href="#modelprototypebasemodelname" title="Permanent link">&para;</a></h2>
<p>If this is a discriminator model, <code>baseModelName</code> is the name of the base model.</p>
<h2 id="modelprototypesave">Model.prototype.save()<a class="headerlink" href="#modelprototypesave" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[fn] «Function» optional callback</li>
</ul>
<p><strong>返回</strong></p>
<p>Saves this document.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nv">product</span>.<span class="nv">sold</span> <span class="o">=</span> <span class="nv">Date</span>.<span class="nv">now</span><span class="ss">()</span><span class="c1">;</span>
<span class="nv">product</span>.<span class="nv">save</span><span class="ss">(</span><span class="nv">function</span> <span class="ss">(</span><span class="nv">err</span>, <span class="nv">product</span><span class="ss">)</span> {
  <span class="k">if</span> <span class="ss">(</span><span class="nv">err</span><span class="ss">)</span> ..
}<span class="ss">)</span>
</code></pre></div>

<p>The callback will receive three parameters</p>
<ol>
<li><code>err</code> if an error occurred</li>
<li><code>product</code> which is the saved <code>product</code></li>
</ol>
<p>As an extra measure of flow control, save will return a Promise.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nv">product</span>.<span class="nv">save</span><span class="ss">()</span>.<span class="k">then</span><span class="ss">(</span><span class="nv">function</span><span class="ss">(</span><span class="nv">product</span><span class="ss">)</span> {
   ...
}<span class="ss">)</span><span class="c1">;</span>
</code></pre></div>

<h2 id="modelprototypeincrement">Model.prototype.increment()<a class="headerlink" href="#modelprototypeincrement" title="Permanent link">&para;</a></h2>
<p>Signal that we desire an increment of this documents version.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code>Model.findById(id, function (err, doc) {
  doc.increment();
  doc.save(function (err) { .. })
})
</code></pre></div>

<h2 id="modelprototyperemove">Model.prototype.remove()<a class="headerlink" href="#modelprototyperemove" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[fn] «function(err,product)» optional callback</li>
</ul>
<p><strong>返回</strong></p>
<p>Removes this document from the db.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nv">product</span>.<span class="nv">remove</span><span class="ss">(</span><span class="nv">function</span> <span class="ss">(</span><span class="nv">err</span>, <span class="nv">product</span><span class="ss">)</span> {
  <span class="k">if</span> <span class="ss">(</span><span class="nv">err</span><span class="ss">)</span> <span class="k">return</span> <span class="nv">handleError</span><span class="ss">(</span><span class="nv">err</span><span class="ss">)</span><span class="c1">;</span>
  <span class="nv">Product</span>.<span class="nv">findById</span><span class="ss">(</span><span class="nv">product</span>.<span class="nv">_id</span>, <span class="nv">function</span> <span class="ss">(</span><span class="nv">err</span>, <span class="nv">product</span><span class="ss">)</span> {
    <span class="nv">console</span>.<span class="nv">log</span><span class="ss">(</span><span class="nv">product</span><span class="ss">)</span>
  }<span class="ss">)</span>
}<span class="ss">)</span>
</code></pre></div>

<p>As an extra measure of flow control, remove will return a Promise (bound to <code>fn</code> if passed) so it could be chained, or hooked to recive errors</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nv">product</span>.<span class="nv">remove</span><span class="ss">()</span>.<span class="k">then</span><span class="ss">(</span><span class="nv">function</span> <span class="ss">(</span><span class="nv">product</span><span class="ss">)</span> {
   ...
}<span class="ss">)</span>.<span class="nv">catch</span><span class="ss">(</span><span class="nv">function</span> <span class="ss">(</span><span class="nv">err</span><span class="ss">)</span> {
   <span class="nv">assert</span>.<span class="nv">ok</span><span class="ss">(</span><span class="nv">err</span><span class="ss">)</span>
}<span class="ss">)</span>
</code></pre></div>

<h2 id="modelprototypemodel">Model.prototype.model()<a class="headerlink" href="#modelprototypemodel" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>name «String» model name</li>
</ul>
<p>Returns another Model instance.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="k">var</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Tank</span><span class="p">;</span>
<span class="n">doc</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">findById</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">callback</span><span class="p">);</span>
</code></pre></div>

<h2 id="modeldiscriminator">Model.discriminator()<a class="headerlink" href="#modeldiscriminator" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>schema «Schema» discriminator model schema</li>
</ul>
<p>Adds a discriminator type.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">function</span> <span class="n">BaseSchema</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">Schema</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">arguments</span><span class="p">);</span>

  <span class="n">this</span><span class="o">.</span><span class="n">add</span><span class="p">({</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb nb-Type">String</span><span class="p">,</span>
    <span class="n">createdAt</span><span class="p">:</span> <span class="n">Date</span>
  <span class="p">});</span>
<span class="p">}</span>
<span class="n">util</span><span class="o">.</span><span class="n">inherits</span><span class="p">(</span><span class="n">BaseSchema</span><span class="p">,</span> <span class="n">Schema</span><span class="p">);</span>

<span class="k">var</span> <span class="n">PersonSchema</span> <span class="o">=</span> <span class="n">new</span> <span class="n">BaseSchema</span><span class="p">();</span>
<span class="k">var</span> <span class="n">BossSchema</span> <span class="o">=</span> <span class="n">new</span> <span class="n">BaseSchema</span><span class="p">({</span> <span class="n">department</span><span class="p">:</span> <span class="nb nb-Type">String</span> <span class="p">});</span>

<span class="k">var</span> <span class="n">Person</span> <span class="o">=</span> <span class="n">mongoose</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="s1">&#39;Person&#39;</span><span class="p">,</span> <span class="n">PersonSchema</span><span class="p">);</span>
<span class="k">var</span> <span class="n">Boss</span> <span class="o">=</span> <span class="n">Person</span><span class="o">.</span><span class="n">discriminator</span><span class="p">(</span><span class="s1">&#39;Boss&#39;</span><span class="p">,</span> <span class="n">BossSchema</span><span class="p">);</span>
</code></pre></div>

<h2 id="modelinit">Model.init()<a class="headerlink" href="#modelinit" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p>Performs any async initialization of this model against MongoDB. Currently, this function is only responsible for building [indexes, unless [<code>autoIndex</code> is turned off.</p>
<p>This function is called automatically, so you don't need to call it. This function is also idempotent, so you may call it to get back a promise that will resolve when your indexes are finished building as an alternative to <code>MyModel.on('index')</code></p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="k">var</span> <span class="n">eventSchema</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Schema</span><span class="p">({</span> <span class="n">thing</span><span class="p">:</span> <span class="p">{</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="n">unique</span><span class="p">:</span> <span class="bp">true</span> <span class="p">}})</span>


<span class="k">var</span> <span class="n">Event</span> <span class="o">=</span> <span class="n">mongoose</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="s1">&#39;Event&#39;</span><span class="p">,</span> <span class="n">eventSchema</span><span class="p">);</span>

<span class="n">Event</span><span class="o">.</span><span class="n">init</span><span class="p">()</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">Event</span><span class="p">)</span> <span class="p">{</span>


  <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Indexes are done building!&#39;</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>

<h2 id="modelensureindexes">Model.ensureIndexes()<a class="headerlink" href="#modelensureindexes" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[cb] «Function» optional callback</li>
</ul>
<p><strong>返回</strong></p>
<p>Sends <code>createIndex</code> commands to mongo for each index declared in the schema. The <code>createIndex</code> commands are sent in series.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nv">Event</span>.<span class="nv">ensureIndexes</span><span class="ss">(</span><span class="nv">function</span> <span class="ss">(</span><span class="nv">err</span><span class="ss">)</span> {
  <span class="k">if</span> <span class="ss">(</span><span class="nv">err</span><span class="ss">)</span> <span class="k">return</span> <span class="nv">handleError</span><span class="ss">(</span><span class="nv">err</span><span class="ss">)</span><span class="c1">;</span>
}<span class="ss">)</span><span class="c1">;</span>
</code></pre></div>

<p>After completion, an <code>index</code> event is emitted on this <code>Model</code> passing an error if one occurred.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="k">var</span> <span class="n">eventSchema</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Schema</span><span class="p">({</span> <span class="n">thing</span><span class="p">:</span> <span class="p">{</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="n">unique</span><span class="p">:</span> <span class="bp">true</span> <span class="p">}})</span>
<span class="k">var</span> <span class="n">Event</span> <span class="o">=</span> <span class="n">mongoose</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="s1">&#39;Event&#39;</span><span class="p">,</span> <span class="n">eventSchema</span><span class="p">);</span>

<span class="n">Event</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">function</span> <span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="n">console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err</span><span class="p">);</span>
<span class="p">})</span>
</code></pre></div>

<p><em>NOTE: It is not recommended that you run this in production. Index creation may impact database performance depending on your load. Use with caution.</em></p>
<h2 id="modelcreateindexes">Model.createIndexes()<a class="headerlink" href="#modelcreateindexes" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[cb] «Function» optional callback</li>
</ul>
<p><strong>返回</strong></p>
<p>Similar to <code>ensureIndexes()</code>, except for it uses the [<code>createIndex</code> function. The <code>ensureIndex()</code> function checks to see if an index with that name already exists, and, if not, does not attempt to create the index. <code>createIndex()</code> bypasses this check.</p>
<h2 id="modelprototypeschema">Model.prototype.schema<a class="headerlink" href="#modelprototypeschema" title="Permanent link">&para;</a></h2>
<h2 id="modelprototypebase">Model.prototype.base<a class="headerlink" href="#modelprototypebase" title="Permanent link">&para;</a></h2>
<p>Base Mongoose instance the model uses.</p>
<h2 id="modelprototypediscriminators">Model.prototype.discriminators<a class="headerlink" href="#modelprototypediscriminators" title="Permanent link">&para;</a></h2>
<p>Registered discriminators for this model.</p>
<h2 id="modeltranslatealiases">Model.translateAliases()<a class="headerlink" href="#modeltranslatealiases" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>raw «Object» fields/conditions that may contain aliased keys</li>
</ul>
<p><strong>返回</strong></p>
<ul>
<li>«Object» the translated 'pure' fields/conditions</li>
</ul>
<p>Translate any aliases fields/conditions so the final query or document object is pure</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nv">Character</span>
  .<span class="nv">find</span><span class="ss">(</span><span class="nv">Character</span>.<span class="nv">translateAliases</span><span class="ss">(</span>{
    <span class="s1">&#39;</span><span class="s">名</span><span class="s1">&#39;</span>: <span class="s1">&#39;</span><span class="s">Eddard Stark</span><span class="s1">&#39;</span>
  }<span class="ss">)</span>
  .<span class="k">exec</span><span class="ss">(</span><span class="nv">function</span><span class="ss">(</span><span class="nv">err</span>, <span class="nv">characters</span><span class="ss">)</span> {}<span class="ss">)</span>
</code></pre></div>

<p><strong>注释</strong></p>
<p>Only translate arguments of object type anything else is returned raw</p>
<h2 id="modelremove">Model.remove()<a class="headerlink" href="#modelremove" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Removes all documents that match <code>conditions</code> from the collection. To remove just the first document that matches <code>conditions</code>, set the <code>single</code> option to true.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nt">Character</span><span class="p">.</span><span class="nc">remove</span><span class="o">(</span><span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Eddard Stark&#39;</span> <span class="p">}</span><span class="o">,</span> <span class="nt">function</span> <span class="o">(</span><span class="nt">err</span><span class="o">)</span> <span class="p">{}</span><span class="o">);</span>
</code></pre></div>

<p><strong>注释</strong></p>
<p>This method sends a remove command directly to MongoDB, no Mongoose documents are involved. Because no Mongoose documents are involved, <em>no middleware (hooks) are executed</em>.</p>
<h2 id="modeldeleteone">Model.deleteOne()<a class="headerlink" href="#modeldeleteone" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Deletes the first document that matches <code>conditions</code> from the collection. Behaves like <code>remove()</code>, but deletes at most one document regardless of the <code>single</code> option.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nt">Character</span><span class="p">.</span><span class="nc">deleteOne</span><span class="o">(</span><span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Eddard Stark&#39;</span> <span class="p">}</span><span class="o">,</span> <span class="nt">function</span> <span class="o">(</span><span class="nt">err</span><span class="o">)</span> <span class="p">{}</span><span class="o">);</span>
</code></pre></div>

<p><strong>注释</strong></p>
<p>Like <code>Model.remove()</code>, this function does <strong>not</strong> trigger <code>pre('remove')</code> or <code>post('remove')</code> hooks.</p>
<hr />
<h2 id="modeldeletemany">Model.deleteMany()<a class="headerlink" href="#modeldeletemany" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Deletes all of the documents that match <code>conditions</code> from the collection. Behaves like <code>remove()</code>, but deletes all documents that match <code>conditions</code> regardless of the <code>single</code> option.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nt">Character</span><span class="p">.</span><span class="nc">deleteMany</span><span class="o">(</span><span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="o">/</span><span class="n">Stark</span><span class="o">/</span><span class="p">,</span> <span class="n">age</span><span class="o">:</span> <span class="err">{</span> <span class="err">$</span><span class="n">gte</span><span class="o">:</span> <span class="mi">18</span> <span class="p">}</span> <span class="err">}</span><span class="o">,</span> <span class="nt">function</span> <span class="o">(</span><span class="nt">err</span><span class="o">)</span> <span class="p">{}</span><span class="o">);</span>
</code></pre></div>

<p><strong>注释</strong></p>
<p>Like <code>Model.remove()</code>, this function does <strong>not</strong> trigger <code>pre('remove')</code> or <code>post('remove')</code> hooks.</p>
<hr />
<h2 id="modelfind">Model.find()<a class="headerlink" href="#modelfind" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Finds documents</p>
<p>The <code>conditions</code> are cast to their respective SchemaTypes before the command is sent.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">MyModel</span><span class="o">.</span><span class="n">find</span><span class="p">({</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;john&#39;</span><span class="p">,</span> <span class="n">age</span><span class="p">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">gte</span><span class="p">:</span> <span class="mi">18</span> <span class="p">}});</span>


<span class="n">MyModel</span><span class="o">.</span><span class="n">find</span><span class="p">({</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;john&#39;</span><span class="p">,</span> <span class="n">age</span><span class="p">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">gte</span><span class="p">:</span> <span class="mi">18</span> <span class="p">}},</span> <span class="n">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">docs</span><span class="p">)</span> <span class="p">{});</span>


<span class="n">MyModel</span><span class="o">.</span><span class="n">find</span><span class="p">({</span> <span class="n">name</span><span class="p">:</span> <span class="o">/</span><span class="n">john</span><span class="o">/</span><span class="n">i</span> <span class="p">},</span> <span class="s1">&#39;name friends&#39;</span><span class="p">,</span> <span class="n">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">docs</span><span class="p">)</span> <span class="p">{</span> <span class="p">})</span>


<span class="n">MyModel</span><span class="o">.</span><span class="n">find</span><span class="p">({</span> <span class="n">name</span><span class="p">:</span> <span class="o">/</span><span class="n">john</span><span class="o">/</span><span class="n">i</span> <span class="p">},</span> <span class="nb nb-Type">null</span><span class="p">,</span> <span class="p">{</span> <span class="n">skip</span><span class="p">:</span> <span class="mi">10</span> <span class="p">})</span>


<span class="n">MyModel</span><span class="o">.</span><span class="n">find</span><span class="p">({</span> <span class="n">name</span><span class="p">:</span> <span class="o">/</span><span class="n">john</span><span class="o">/</span><span class="n">i</span> <span class="p">},</span> <span class="nb nb-Type">null</span><span class="p">,</span> <span class="p">{</span> <span class="n">skip</span><span class="p">:</span> <span class="mi">10</span> <span class="p">},</span> <span class="n">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">docs</span><span class="p">)</span> <span class="p">{});</span>


<span class="k">var</span> <span class="n">query</span> <span class="o">=</span> <span class="n">MyModel</span><span class="o">.</span><span class="n">find</span><span class="p">({</span> <span class="n">name</span><span class="p">:</span> <span class="o">/</span><span class="n">john</span><span class="o">/</span><span class="n">i</span> <span class="p">},</span> <span class="nb nb-Type">null</span><span class="p">,</span> <span class="p">{</span> <span class="n">skip</span><span class="p">:</span> <span class="mi">10</span> <span class="p">})</span>
<span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">docs</span><span class="p">)</span> <span class="p">{});</span>


<span class="k">var</span> <span class="n">query</span> <span class="o">=</span> <span class="n">MyModel</span><span class="o">.</span><span class="n">find</span><span class="p">({</span> <span class="n">name</span><span class="p">:</span> <span class="o">/</span><span class="n">john</span><span class="o">/</span><span class="n">i</span> <span class="p">},</span> <span class="nb nb-Type">null</span><span class="p">,</span> <span class="p">{</span> <span class="n">skip</span><span class="p">:</span> <span class="mi">10</span> <span class="p">});</span>
<span class="k">var</span> <span class="n">promise</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">();</span>
<span class="n">promise</span><span class="o">.</span><span class="n">addBack</span><span class="p">(</span><span class="n">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">docs</span><span class="p">)</span> <span class="p">{});</span>
</code></pre></div>

<h2 id="modelfindbyid">Model.findById()<a class="headerlink" href="#modelfindbyid" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Finds a single document by its _id field. <code>findById(id)</code> is almost* equivalent to <code>findOne({ _id: id })</code>. If you want to query by a document's <code>_id</code>, use <code>findById()</code> instead of <code>findOne()</code>.</p>
<p>The <code>id</code> is cast based on the Schema before sending the command.</p>
<p>This function triggers the following middleware.</p>
<ul>
<li>Except for how it treats <code>undefined</code>. If you use <code>findOne()</code>, you'll see that <code>findOne(undefined)</code> and <code>findOne({ _id: undefined })</code> are equivalent to <code>findOne({})</code> and return arbitrary documents. However, mongoose translates <code>findById(undefined)</code> into <code>findOne({ _id: null })</code>.</li>
</ul>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nt">Adventure</span><span class="p">.</span><span class="nc">findById</span><span class="o">(</span><span class="nt">id</span><span class="o">,</span> <span class="nt">function</span> <span class="o">(</span><span class="nt">err</span><span class="o">,</span> <span class="nt">adventure</span><span class="o">)</span> <span class="p">{}</span><span class="o">);</span>


<span class="nt">Adventure</span><span class="p">.</span><span class="nc">findById</span><span class="o">(</span><span class="nt">id</span><span class="o">)</span><span class="p">.</span><span class="nc">exec</span><span class="o">(</span><span class="nt">callback</span><span class="o">);</span>


<span class="nt">Adventure</span><span class="p">.</span><span class="nc">findById</span><span class="o">(</span><span class="nt">id</span><span class="o">,</span> <span class="s1">&#39;name length&#39;</span><span class="o">,</span> <span class="nt">function</span> <span class="o">(</span><span class="nt">err</span><span class="o">,</span> <span class="nt">adventure</span><span class="o">)</span> <span class="p">{}</span><span class="o">);</span>


<span class="nt">Adventure</span><span class="p">.</span><span class="nc">findById</span><span class="o">(</span><span class="nt">id</span><span class="o">,</span> <span class="s1">&#39;name length&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">exec</span><span class="o">(</span><span class="nt">callback</span><span class="o">);</span>


<span class="nt">Adventure</span><span class="p">.</span><span class="nc">findById</span><span class="o">(</span><span class="nt">id</span><span class="o">,</span> <span class="s1">&#39;-length&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">exec</span><span class="o">(</span><span class="nt">function</span> <span class="o">(</span><span class="nt">err</span><span class="o">,</span> <span class="nt">adventure</span><span class="o">)</span> <span class="p">{}</span><span class="o">);</span>


<span class="nt">Adventure</span><span class="p">.</span><span class="nc">findById</span><span class="o">(</span><span class="nt">id</span><span class="o">,</span> <span class="s1">&#39;name&#39;</span><span class="o">,</span> <span class="p">{</span> <span class="n">lean</span><span class="p">:</span> <span class="n">true</span> <span class="p">}</span><span class="o">,</span> <span class="nt">function</span> <span class="o">(</span><span class="nt">err</span><span class="o">,</span> <span class="nt">doc</span><span class="o">)</span> <span class="p">{}</span><span class="o">);</span>


<span class="nt">Adventure</span><span class="p">.</span><span class="nc">findById</span><span class="o">(</span><span class="nt">id</span><span class="o">,</span> <span class="s1">&#39;name&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">lean</span><span class="o">()</span><span class="p">.</span><span class="nc">exec</span><span class="o">(</span><span class="nt">function</span> <span class="o">(</span><span class="nt">err</span><span class="o">,</span> <span class="nt">doc</span><span class="o">)</span> <span class="p">{}</span><span class="o">);</span>
</code></pre></div>

<h2 id="modelfindone">Model.findOne()<a class="headerlink" href="#modelfindone" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Finds one document.</p>
<p>The <code>conditions</code> are cast to their respective SchemaTypes before the command is sent.</p>
<p><em>Note:</em> <code>conditions</code> is optional, and if <code>conditions</code> is null or undefined, mongoose will send an empty <code>findOne</code> command to MongoDB, which will return an arbitrary document. If you're querying by <code>_id</code>, use <code>findById()</code> instead.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nt">Adventure</span><span class="p">.</span><span class="nc">findOne</span><span class="o">(</span><span class="p">{</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;iphone&#39;</span> <span class="p">}</span><span class="o">,</span> <span class="nt">function</span> <span class="o">(</span><span class="nt">err</span><span class="o">,</span> <span class="nt">adventure</span><span class="o">)</span> <span class="p">{}</span><span class="o">);</span>


<span class="nt">Adventure</span><span class="p">.</span><span class="nc">findOne</span><span class="o">(</span><span class="p">{</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;iphone&#39;</span> <span class="p">}</span><span class="o">)</span><span class="p">.</span><span class="nc">exec</span><span class="o">(</span><span class="nt">function</span> <span class="o">(</span><span class="nt">err</span><span class="o">,</span> <span class="nt">adventure</span><span class="o">)</span> <span class="p">{}</span><span class="o">);</span>


<span class="nt">Adventure</span><span class="p">.</span><span class="nc">findOne</span><span class="o">(</span><span class="p">{</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;iphone&#39;</span> <span class="p">}</span><span class="o">,</span> <span class="s1">&#39;name&#39;</span><span class="o">,</span> <span class="nt">function</span> <span class="o">(</span><span class="nt">err</span><span class="o">,</span> <span class="nt">adventure</span><span class="o">)</span> <span class="p">{}</span><span class="o">);</span>


<span class="nt">Adventure</span><span class="p">.</span><span class="nc">findOne</span><span class="o">(</span><span class="p">{</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;iphone&#39;</span> <span class="p">}</span><span class="o">,</span> <span class="s1">&#39;name&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">exec</span><span class="o">(</span><span class="nt">function</span> <span class="o">(</span><span class="nt">err</span><span class="o">,</span> <span class="nt">adventure</span><span class="o">)</span> <span class="p">{}</span><span class="o">);</span>


<span class="nt">Adventure</span><span class="p">.</span><span class="nc">findOne</span><span class="o">(</span><span class="p">{</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;iphone&#39;</span> <span class="p">}</span><span class="o">,</span> <span class="s1">&#39;name&#39;</span><span class="o">,</span> <span class="p">{</span> <span class="n">lean</span><span class="p">:</span> <span class="n">true</span> <span class="p">}</span><span class="o">,</span> <span class="nt">callback</span><span class="o">);</span>


<span class="nt">Adventure</span><span class="p">.</span><span class="nc">findOne</span><span class="o">(</span><span class="p">{</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;iphone&#39;</span> <span class="p">}</span><span class="o">,</span> <span class="s1">&#39;name&#39;</span><span class="o">,</span> <span class="p">{</span> <span class="n">lean</span><span class="p">:</span> <span class="n">true</span> <span class="p">}</span><span class="o">)</span><span class="p">.</span><span class="nc">exec</span><span class="o">(</span><span class="nt">callback</span><span class="o">);</span>


<span class="nt">Adventure</span><span class="p">.</span><span class="nc">findOne</span><span class="o">(</span><span class="p">{</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;iphone&#39;</span> <span class="p">}</span><span class="o">)</span><span class="p">.</span><span class="nc">select</span><span class="o">(</span><span class="s1">&#39;name&#39;</span><span class="o">)</span><span class="p">.</span><span class="nc">lean</span><span class="o">()</span><span class="p">.</span><span class="nc">exec</span><span class="o">(</span><span class="nt">callback</span><span class="o">);</span>
</code></pre></div>

<h2 id="modelcount">Model.count()<a class="headerlink" href="#modelcount" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Counts number of matching documents in a database collection.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nt">Adventure</span><span class="p">.</span><span class="nc">count</span><span class="o">(</span><span class="p">{</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;jungle&#39;</span> <span class="p">}</span><span class="o">,</span> <span class="nt">function</span> <span class="o">(</span><span class="nt">err</span><span class="o">,</span> <span class="nt">count</span><span class="o">)</span> <span class="p">{</span>
  <span class="err">if</span> <span class="err">(err)</span> <span class="err">..</span>
  <span class="err">console.log(&#39;there</span> <span class="err">are</span> <span class="err">%d</span> <span class="err">jungle</span> <span class="err">adventures&#39;,</span> <span class="err">count)</span><span class="p">;</span>
<span class="p">}</span><span class="o">);</span>
</code></pre></div>

<h2 id="modeldistinct">Model.distinct()<a class="headerlink" href="#modeldistinct" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Creates a Query for a <code>distinct</code> operation.</p>
<p>Passing a <code>callback</code> immediately executes the query.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">Link</span><span class="o">.</span><span class="n">distinct</span><span class="p">(</span><span class="s1">&#39;url&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="n">clicks</span><span class="p">:</span> <span class="p">{</span><span class="o">$</span><span class="n">gt</span><span class="p">:</span> <span class="mi">100</span><span class="p">}},</span> <span class="n">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="k">return</span> <span class="n">handleError</span><span class="p">(</span><span class="n">err</span><span class="p">);</span>

  <span class="nb">assert</span><span class="p">(</span><span class="nb nb-Type">Array</span><span class="o">.</span><span class="n">isArray</span><span class="p">(</span><span class="n">result</span><span class="p">));</span>
  <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;unique urls with more than 100 clicks&#39;</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
<span class="p">})</span>

<span class="k">var</span> <span class="n">query</span> <span class="o">=</span> <span class="n">Link</span><span class="o">.</span><span class="n">distinct</span><span class="p">(</span><span class="s1">&#39;url&#39;</span><span class="p">);</span>
<span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">callback</span><span class="p">);</span>
</code></pre></div>

<h2 id="modelwhere">Model.where()<a class="headerlink" href="#modelwhere" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[val] «Object» optional value</li>
</ul>
<p><strong>返回</strong></p>
<p>Creates a Query, applies the passed conditions, and returns the Query.</p>
<p>For example, instead of writing:</p>
<div class="codehilite"><pre><span></span><code><span class="nt">User</span><span class="p">.</span><span class="nc">find</span><span class="o">(</span><span class="p">{</span><span class="n">age</span><span class="p">:</span> <span class="err">{$</span><span class="n">gte</span><span class="o">:</span> <span class="mi">21</span><span class="p">,</span> <span class="err">$</span><span class="n">lte</span><span class="o">:</span> <span class="mi">65</span><span class="p">}</span><span class="err">}</span><span class="o">,</span> <span class="nt">callback</span><span class="o">);</span>
</code></pre></div>

<p>we can instead write:</p>
<div class="codehilite"><pre><span></span><code><span class="nv">User</span>.<span class="nv">where</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">age</span><span class="s1">&#39;</span><span class="ss">)</span>.<span class="nv">gte</span><span class="ss">(</span><span class="mi">21</span><span class="ss">)</span>.<span class="nv">lte</span><span class="ss">(</span><span class="mi">65</span><span class="ss">)</span>.<span class="k">exec</span><span class="ss">(</span><span class="nv">callback</span><span class="ss">)</span><span class="c1">;</span>
</code></pre></div>

<p>Since the Query class also supports <code>where</code> you can continue chaining</p>
<div class="codehilite"><pre><span></span><code><span class="nf">User</span>
<span class="na">.where</span><span class="p">(</span><span class="err">&#39;</span><span class="no">age</span><span class="err">&#39;</span><span class="p">).</span><span class="no">gte</span><span class="p">(</span><span class="mi">21</span><span class="p">).</span><span class="no">lte</span><span class="p">(</span><span class="mi">65</span><span class="p">)</span>
<span class="na">.where</span><span class="p">(</span><span class="err">&#39;</span><span class="no">name</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">/^</span><span class="no">b</span><span class="err">/</span><span class="no">i</span><span class="p">)</span>
<span class="na">...</span> <span class="no">etc</span>
</code></pre></div>

<h2 id="modelprototypewhere_1">Model.prototype.$where()<a class="headerlink" href="#modelprototypewhere_1" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>argument «String,Function» is a javascript string or anonymous function</li>
</ul>
<p><strong>返回</strong></p>
<p>Creates a <code>Query</code> and specifies a <code>$where</code> condition.</p>
<p>Sometimes you need to query for things in mongodb using a JavaScript expression. You can do so via <code>find({ $where: javascript })</code>, or you can use the mongoose shortcut method $where via a Query chain or from your mongoose Model.</p>
<div class="codehilite"><pre><span></span><code><span class="nv">Blog</span>.$<span class="nv">where</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">this.username.indexOf(&quot;val&quot;) !== -1</span><span class="s1">&#39;</span><span class="ss">)</span>.<span class="k">exec</span><span class="ss">(</span><span class="nv">function</span> <span class="ss">(</span><span class="nv">err</span>, <span class="nv">docs</span><span class="ss">)</span> {}<span class="ss">)</span><span class="c1">;</span>
</code></pre></div>

<h2 id="modelfindoneandupdate">Model.findOneAndUpdate()<a class="headerlink" href="#modelfindoneandupdate" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Issues a mongodb findAndModify update command.</p>
<p>Finds a matching document, updates it according to the <code>update</code> arg, passing any <code>options</code>, and returns the found document (if any) to the callback. The query executes immediately if <code>callback</code> is passed else a Query object is returned.</p>
<p><strong>选项</strong></p>
<ul>
<li><code>new</code>: bool - if true, return the modified document rather than the original. defaults to false (changed in 4.0)</li>
<li><code>upsert</code>: bool - creates the object if it doesn't exist. defaults to false.</li>
<li><code>fields</code>: {Object|String} - Field selection. Equivalent to <code>.select(fields).findOneAndUpdate()</code></li>
<li><code>maxTimeMS</code>: puts a time limit on the query - requires mongodb &gt;= 2.6.0</li>
<li><code>sort</code>: if multiple docs are found by the conditions, sets the sort order to choose which doc to update</li>
<li><code>runValidators</code>: if true, runs [update validators on this command. Update validators validate the update operation against the model's schema.</li>
<li><code>setDefaultsOnInsert</code>: if this and <code>upsert</code> are true, mongoose will apply the [defaults specified in the model's schema if a new document is created. This option only works on MongoDB &gt;= 2.4 because it relies on [MongoDB's <code>$setOnInsert</code> operator.</li>
<li><code>rawResult</code>: if true, returns the [raw result from the MongoDB driver</li>
<li><code>strict</code>: overwrites the schema's [strict mode option for this update</li>
</ul>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code>A.findOneAndUpdate(conditions, update, options, callback)
A.findOneAndUpdate(conditions, update, options)
A.findOneAndUpdate(conditions, update, callback)
A.findOneAndUpdate(conditions, update)
A.findOneAndUpdate()
</code></pre></div>

<p><strong>注释</strong></p>
<p>All top level update keys which are not <code>atomic</code> operation names are treated as set operations:</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="k">var</span> <span class="n">query</span> <span class="o">=</span> <span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;borne&#39;</span> <span class="p">};</span>
<span class="n">Model</span><span class="o">.</span><span class="n">findOneAndUpdate</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;jason bourne&#39;</span> <span class="p">},</span> <span class="n">options</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>


<span class="n">Model</span><span class="o">.</span><span class="n">findOneAndUpdate</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">{</span> <span class="o">$</span><span class="n">set</span><span class="p">:</span> <span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;jason bourne&#39;</span> <span class="p">}},</span> <span class="n">options</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
</code></pre></div>

<p>This helps prevent accidentally overwriting your document with <code>{ name: 'jason bourne' }</code>.</p>
<p><strong>注释</strong></p>
<p>Values are cast to their appropriate types when using the findAndModify helpers. However, the below are not executed by default.</p>
<ul>
<li>defaults. Use the <code>setDefaultsOnInsert</code> option to override.</li>
</ul>
<p><code>findAndModify</code> helpers support limited validation. You can enable these by setting the <code>runValidators</code> options, respectively.</p>
<p>If you need full-fledged validation, use the traditional approach of first retrieving the document.</p>
<div class="codehilite"><pre><span></span><code><span class="nv">Model</span>.<span class="nv">findById</span><span class="ss">(</span><span class="nv">id</span>, <span class="nv">function</span> <span class="ss">(</span><span class="nv">err</span>, <span class="nv">doc</span><span class="ss">)</span> {
  <span class="k">if</span> <span class="ss">(</span><span class="nv">err</span><span class="ss">)</span> ..
  <span class="nv">doc</span>.<span class="nv">name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">jason bourne</span><span class="s1">&#39;</span><span class="c1">;</span>
  <span class="nv">doc</span>.<span class="nv">save</span><span class="ss">(</span><span class="nv">callback</span><span class="ss">)</span><span class="c1">;</span>
}<span class="ss">)</span><span class="c1">;</span>
</code></pre></div>

<h2 id="modelfindbyidandupdate">Model.findByIdAndUpdate()<a class="headerlink" href="#modelfindbyidandupdate" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Issues a mongodb findAndModify update command by a document's _id field. <code>findByIdAndUpdate(id, ...)</code> is equivalent to <code>findOneAndUpdate({ _id: id }, ...)</code>.</p>
<p>Finds a matching document, updates it according to the <code>update</code> arg, passing any <code>options</code>, and returns the found document (if any) to the callback. The query executes immediately if <code>callback</code> is passed else a Query object is returned.</p>
<p>This function triggers the following middleware.</p>
<p><strong>选项</strong></p>
<ul>
<li><code>new</code>: bool - true to return the modified document rather than the original. defaults to false</li>
<li><code>upsert</code>: bool - creates the object if it doesn't exist. defaults to false.</li>
<li><code>runValidators</code>: if true, runs [update validators on this command. Update validators validate the update operation against the model's schema.</li>
<li><code>setDefaultsOnInsert</code>: if this and <code>upsert</code> are true, mongoose will apply the [defaults specified in the model's schema if a new document is created. This option only works on MongoDB &gt;= 2.4 because it relies on [MongoDB's <code>$setOnInsert</code> operator.</li>
<li><code>sort</code>: if multiple docs are found by the conditions, sets the sort order to choose which doc to update</li>
<li><code>select</code>: sets the document fields to return</li>
<li><code>rawResult</code>: if true, returns the [raw result from the MongoDB driver</li>
<li><code>strict</code>: overwrites the schema's [strict mode option for this update</li>
</ul>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code>A.findByIdAndUpdate(id, update, options, callback)
A.findByIdAndUpdate(id, update, options)
A.findByIdAndUpdate(id, update, callback)
A.findByIdAndUpdate(id, update)
A.findByIdAndUpdate()
</code></pre></div>

<p><strong>注释</strong></p>
<p>All top level update keys which are not <code>atomic</code> operation names are treated as set operations:</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code>Model.findByIdAndUpdate(id, { name: &#39;jason bourne&#39; }, options, callback)


Model.findByIdAndUpdate(id, { $set: { name: &#39;jason bourne&#39; }}, options, callback)
</code></pre></div>

<p>This helps prevent accidentally overwriting your document with <code>{ name: 'jason bourne' }</code>.</p>
<p><strong>注释</strong></p>
<p>Values are cast to their appropriate types when using the findAndModify helpers. However, the below are not executed by default.</p>
<ul>
<li>defaults. Use the <code>setDefaultsOnInsert</code> option to override.</li>
</ul>
<p><code>findAndModify</code> helpers support limited validation. You can enable these by setting the <code>runValidators</code> options, respectively.</p>
<p>If you need full-fledged validation, use the traditional approach of first retrieving the document.</p>
<div class="codehilite"><pre><span></span><code><span class="nv">Model</span>.<span class="nv">findById</span><span class="ss">(</span><span class="nv">id</span>, <span class="nv">function</span> <span class="ss">(</span><span class="nv">err</span>, <span class="nv">doc</span><span class="ss">)</span> {
  <span class="k">if</span> <span class="ss">(</span><span class="nv">err</span><span class="ss">)</span> ..
  <span class="nv">doc</span>.<span class="nv">name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">jason bourne</span><span class="s1">&#39;</span><span class="c1">;</span>
  <span class="nv">doc</span>.<span class="nv">save</span><span class="ss">(</span><span class="nv">callback</span><span class="ss">)</span><span class="c1">;</span>
}<span class="ss">)</span><span class="c1">;</span>
</code></pre></div>

<h2 id="modelfindoneandremove">Model.findOneAndRemove()<a class="headerlink" href="#modelfindoneandremove" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Issue a mongodb findAndModify remove command.</p>
<p>Finds a matching document, removes it, passing the found document (if any) to the callback.</p>
<p>Executes immediately if <code>callback</code> is passed else a Query object is returned.</p>
<p>This function triggers the following middleware.</p>
<p><strong>选项</strong></p>
<ul>
<li><code>sort</code>: if multiple docs are found by the conditions, sets the sort order to choose which doc to update</li>
<li><code>maxTimeMS</code>: puts a time limit on the query - requires mongodb &gt;= 2.6.0</li>
<li><code>select</code>: sets the document fields to return</li>
<li><code>rawResult</code>: if true, returns the [raw result from the MongoDB driver</li>
<li><code>strict</code>: overwrites the schema's [strict mode option for this update</li>
</ul>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code>A.findOneAndRemove(conditions, options, callback)
A.findOneAndRemove(conditions, options)
A.findOneAndRemove(conditions, callback)
A.findOneAndRemove(conditions)
A.findOneAndRemove()
</code></pre></div>

<p>Values are cast to their appropriate types when using the findAndModify helpers. However, the below are not executed by default.</p>
<ul>
<li>defaults. Use the <code>setDefaultsOnInsert</code> option to override.</li>
</ul>
<p><code>findAndModify</code> helpers support limited validation. You can enable these by setting the <code>runValidators</code> options, respectively.</p>
<p>If you need full-fledged validation, use the traditional approach of first retrieving the document.</p>
<div class="codehilite"><pre><span></span><code><span class="nv">Model</span>.<span class="nv">findById</span><span class="ss">(</span><span class="nv">id</span>, <span class="nv">function</span> <span class="ss">(</span><span class="nv">err</span>, <span class="nv">doc</span><span class="ss">)</span> {
  <span class="k">if</span> <span class="ss">(</span><span class="nv">err</span><span class="ss">)</span> ..
  <span class="nv">doc</span>.<span class="nv">name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">jason bourne</span><span class="s1">&#39;</span><span class="c1">;</span>
  <span class="nv">doc</span>.<span class="nv">save</span><span class="ss">(</span><span class="nv">callback</span><span class="ss">)</span><span class="c1">;</span>
}<span class="ss">)</span><span class="c1">;</span>
</code></pre></div>

<h2 id="modelfindbyidandremove">Model.findByIdAndRemove()<a class="headerlink" href="#modelfindbyidandremove" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Issue a mongodb findAndModify remove command by a document's _id field. <code>findByIdAndRemove(id, ...)</code> is equivalent to <code>findOneAndRemove({ _id: id }, ...)</code>.</p>
<p>Finds a matching document, removes it, passing the found document (if any) to the callback.</p>
<p>Executes immediately if <code>callback</code> is passed, else a <code>Query</code> object is returned.</p>
<p>This function triggers the following middleware.</p>
<p><strong>选项</strong></p>
<ul>
<li><code>sort</code>: if multiple docs are found by the conditions, sets the sort order to choose which doc to update</li>
<li><code>select</code>: sets the document fields to return</li>
<li><code>rawResult</code>: if true, returns the [raw result from the MongoDB driver</li>
<li><code>strict</code>: overwrites the schema's [strict mode option for this update</li>
</ul>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code>A.findByIdAndRemove(id, options, callback)
A.findByIdAndRemove(id, options)
A.findByIdAndRemove(id, callback)
A.findByIdAndRemove(id)
A.findByIdAndRemove()
</code></pre></div>

<h2 id="modelcreate">Model.create()<a class="headerlink" href="#modelcreate" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» callback</li>
</ul>
<p><strong>返回</strong></p>
<p>Shortcut for saving one or more documents to the database. <code>MyModel.create(docs)</code> does <code>new MyModel(doc).save()</code> for every doc in docs.</p>
<p>This function triggers the following middleware.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">Candy</span><span class="o">.</span><span class="n">create</span><span class="p">({</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;jelly bean&#39;</span> <span class="p">},</span> <span class="p">{</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;snickers&#39;</span> <span class="p">},</span> <span class="n">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">jellybean</span><span class="p">,</span> <span class="n">snickers</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="p">});</span>


<span class="k">var</span> <span class="n">array</span> <span class="o">=</span> <span class="p">[{</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;jelly bean&#39;</span> <span class="p">},</span> <span class="p">{</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;snickers&#39;</span> <span class="p">}];</span>
<span class="n">Candy</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">candies</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="p">)</span>

  <span class="k">var</span> <span class="n">jellybean</span> <span class="o">=</span> <span class="n">candies</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  <span class="k">var</span> <span class="n">snickers</span> <span class="o">=</span> <span class="n">candies</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

<span class="p">});</span>


<span class="k">var</span> <span class="n">promise</span> <span class="o">=</span> <span class="n">Candy</span><span class="o">.</span><span class="n">create</span><span class="p">({</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;jawbreaker&#39;</span> <span class="p">});</span>
<span class="n">promise</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">function</span> <span class="p">(</span><span class="n">jawbreaker</span><span class="p">)</span> <span class="p">{</span>

<span class="p">})</span>
</code></pre></div>

<h2 id="modelwatch">Model.watch()<a class="headerlink" href="#modelwatch" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<ul>
<li>«ChangeStream» mongoose-specific change stream wrapper</li>
</ul>
<p><em>Requires a replica set running MongoDB &gt;= 3.6.0.</em> Watches the underlying collection for changes using [MongoDB change streams.</p>
<p>This function does <strong>not</strong> trigger any middleware. In particular, it does <strong>not</strong> trigger aggregate middleware.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="k">const</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">await</span> <span class="n">Person</span><span class="o">.</span><span class="n">create</span><span class="p">({</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Ned Stark&#39;</span> <span class="p">});</span>
<span class="n">Person</span><span class="o">.</span><span class="n">watch</span><span class="p">()</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="n">change</span> <span class="o">=&gt;</span> <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">change</span><span class="p">));</span>





<span class="n">await</span> <span class="n">doc</span><span class="o">.</span><span class="n">remove</span><span class="p">();</span>
</code></pre></div>

<h2 id="modelinsertmany">Model.insertMany()<a class="headerlink" href="#modelinsertmany" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» callback</li>
</ul>
<p><strong>返回</strong></p>
<p>Shortcut for validating an array of documents and inserting them into MongoDB if they're all valid. This function is faster than <code>.create()</code> because it only sends one operation to the server, rather than one for each document.</p>
<p>Mongoose always validates each document <strong>before</strong> sending <code>insertMany</code> to MongoDB. So if one document has a validation error, no documents will be saved, unless you set [the <code>ordered</code> option to false.</p>
<p>This function does <strong>not</strong> trigger save middleware.</p>
<p>This function triggers the following middleware.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="k">var</span> <span class="n">arr</span> <span class="o">=</span> <span class="p">[{</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Star Wars&#39;</span> <span class="p">},</span> <span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;The Empire Strikes Back&#39;</span> <span class="p">}];</span>
<span class="n">Movies</span><span class="o">.</span><span class="n">insertMany</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">docs</span><span class="p">)</span> <span class="p">{});</span>
</code></pre></div>

<h2 id="modelbulkwrite">Model.bulkWrite()<a class="headerlink" href="#modelbulkwrite" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» callback <code>function(error, bulkWriteOpResult) {}</code></li>
</ul>
<p><strong>返回</strong></p>
<ul>
<li>«Promise» resolves to a <code>BulkWriteOpResult</code> if the operation succeeds</li>
</ul>
<p>Sends multiple <code>insertOne</code>, <code>updateOne</code>, <code>updateMany</code>, <code>replaceOne</code>, <code>deleteOne</code>, and/or <code>deleteMany</code> operations to the MongoDB server in one command. This is faster than sending multiple independent operations (like) if you use <code>create()</code>) because with <code>bulkWrite()</code> there is only one round trip to MongoDB.</p>
<p>Mongoose will perform casting on all operations you provide.</p>
<p>This function does <strong>not</strong> trigger any middleware, not <code>save()</code> nor <code>update()</code>. If you need to trigger <code>save()</code> middleware for every document use [<code>create()</code> instead.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nt">Character</span><span class="p">.</span><span class="nc">bulkWrite</span><span class="o">(</span><span class="cp">[</span>
  <span class="p">{</span>
    <span class="nx">insertOne</span><span class="p">:</span> <span class="p">{</span>
      <span class="nb">document</span><span class="p">:</span> <span class="p">{</span>
        <span class="nx">name</span><span class="p">:</span> <span class="s1">&#39;Eddard Stark&#39;</span><span class="p">,</span>
        <span class="nx">title</span><span class="p">:</span> <span class="s1">&#39;Warden of the North&#39;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nx">updateOne</span><span class="p">:</span> <span class="p">{</span>
      <span class="nx">filter</span><span class="p">:</span> <span class="p">{</span> <span class="nx">name</span><span class="p">:</span> <span class="s1">&#39;Eddard Stark&#39;</span> <span class="p">},</span>



      <span class="nx">update</span><span class="p">:</span> <span class="p">{</span> <span class="nx">title</span><span class="p">:</span> <span class="s1">&#39;Hand of the King&#39;</span> <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nx">deleteOne</span><span class="p">:</span> <span class="p">{</span>
      <span class="p">{</span>
        <span class="nx">filter</span><span class="p">:</span> <span class="p">{</span> <span class="nx">name</span><span class="p">:</span> <span class="s1">&#39;Eddard Stark&#39;</span> <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="cp">]</span><span class="o">)</span><span class="p">.</span><span class="nc">then</span><span class="o">(</span><span class="nt">handleResult</span><span class="o">);</span>
</code></pre></div>

<h2 id="modelhydrate">Model.hydrate()<a class="headerlink" href="#modelhydrate" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<ul>
<li>«Model» document instance</li>
</ul>
<p>Shortcut for creating a new Document from existing raw data, pre-saved in the DB. The document returned has no paths marked as modified initially.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="k">var</span> <span class="n">mongooseCandy</span> <span class="o">=</span> <span class="n">Candy</span><span class="o">.</span><span class="n">hydrate</span><span class="p">({</span> <span class="n">_id</span><span class="p">:</span> <span class="s1">&#39;54108337212ffb6d459f854c&#39;</span><span class="p">,</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;jelly bean&#39;</span> <span class="p">});</span>
</code></pre></div>

<h2 id="modelupdate">Model.update()<a class="headerlink" href="#modelupdate" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Updates one document in the database without returning it.</p>
<p>This function triggers the following middleware.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nt">MyModel</span><span class="p">.</span><span class="nc">update</span><span class="o">(</span><span class="p">{</span> <span class="n">age</span><span class="p">:</span> <span class="err">{</span> <span class="err">$</span><span class="n">gt</span><span class="o">:</span> <span class="mi">18</span> <span class="p">}</span> <span class="err">}</span><span class="o">,</span> <span class="p">{</span> <span class="n">oldEnough</span><span class="p">:</span> <span class="n">true</span> <span class="p">}</span><span class="o">,</span> <span class="nt">fn</span><span class="o">);</span>
<span class="nt">MyModel</span><span class="p">.</span><span class="nc">update</span><span class="o">(</span><span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Tobi&#39;</span> <span class="p">}</span><span class="o">,</span> <span class="p">{</span> <span class="n">ferret</span><span class="p">:</span> <span class="n">true</span> <span class="p">}</span><span class="o">,</span> <span class="p">{</span> <span class="n">multi</span><span class="p">:</span> <span class="n">true</span> <span class="p">}</span><span class="o">,</span> <span class="nt">function</span> <span class="o">(</span><span class="nt">err</span><span class="o">,</span> <span class="nt">raw</span><span class="o">)</span> <span class="p">{</span>
  <span class="err">if</span> <span class="err">(err)</span> <span class="err">return</span> <span class="err">handleError(err)</span><span class="p">;</span>
  <span class="err">console.log(&#39;The</span> <span class="err">raw</span> <span class="err">response</span> <span class="err">from</span> <span class="err">Mongo</span> <span class="err">was</span> <span class="err">&#39;,</span> <span class="err">raw)</span><span class="p">;</span>
<span class="p">}</span><span class="o">);</span>
</code></pre></div>

<p><strong>有效的选项</strong></p>
<ul>
<li><code>safe</code> (boolean) safe mode (defaults to value set in schema (true))</li>
<li><code>upsert</code> (boolean) whether to create the doc if it doesn't match (false)</li>
<li><code>multi</code> (boolean) whether multiple documents should be updated (false)</li>
<li><code>runValidators</code>: if true, runs [update validators on this command. Update validators validate the update operation against the model's schema.</li>
<li><code>setDefaultsOnInsert</code>: if this and <code>upsert</code> are true, mongoose will apply the [defaults specified in the model's schema if a new document is created. This option only works on MongoDB &gt;= 2.4 because it relies on [MongoDB's <code>$setOnInsert</code> operator.</li>
<li><code>strict</code> (boolean) overrides the <code>strict</code> option for this update</li>
<li><code>overwrite</code> (boolean) disables update-only mode, allowing you to overwrite the doc (false)</li>
</ul>
<p>All <code>update</code> values are cast to their appropriate SchemaTypes before being sent.</p>
<p>The <code>callback</code> function receives <code>(err, rawResponse)</code>.</p>
<ul>
<li><code>err</code> is the error if any occurred</li>
<li><code>rawResponse</code> is the full response from Mongo</li>
</ul>
<p><strong>注释</strong></p>
<p>All top level keys which are not <code>atomic</code> operation names are treated as set operations:</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="k">var</span> <span class="n">query</span> <span class="o">=</span> <span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;borne&#39;</span> <span class="p">};</span>
<span class="n">Model</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;jason bourne&#39;</span> <span class="p">},</span> <span class="n">options</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>


<span class="n">Model</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">{</span> <span class="o">$</span><span class="n">set</span><span class="p">:</span> <span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;jason bourne&#39;</span> <span class="p">}},</span> <span class="n">options</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
</code></pre></div>

<p>This helps prevent accidentally overwriting all documents in your collection with <code>{ name: 'jason bourne' }</code>.</p>
<p><strong>注释</strong></p>
<p>Be careful to not use an existing model instance for the update clause (this won't work and can cause weird behavior like infinite loops). Also, ensure that the update clause does not have an _id property, which causes Mongo to return a "Mod on _id not allowed" error.</p>
<p><strong>注释</strong></p>
<p>To update documents without waiting for a response from MongoDB, do not pass a <code>callback</code>, then call <code>exec</code> on the returned [Query:</p>
<div class="codehilite"><pre><span></span><code><span class="nt">Comment</span><span class="p">.</span><span class="nc">update</span><span class="o">(</span><span class="p">{</span> <span class="n">_id</span><span class="p">:</span> <span class="n">id</span> <span class="p">}</span><span class="o">,</span> <span class="p">{</span> <span class="err">$</span><span class="n">set</span><span class="p">:</span> <span class="err">{</span> <span class="kc">text</span><span class="o">:</span> <span class="s1">&#39;changed&#39;</span> <span class="p">}</span><span class="err">}</span><span class="o">)</span><span class="p">.</span><span class="nc">exec</span><span class="o">();</span>
</code></pre></div>

<p><strong>注释</strong></p>
<p>Although values are casted to their appropriate types when using update, the following are <em>not</em> applied:</p>
<ul>
<li>defaults</li>
<li>setters</li>
<li>validators</li>
<li>middleware</li>
</ul>
<p>If you need those features, use the traditional approach of first retrieving the document.</p>
<div class="codehilite"><pre><span></span><code><span class="nt">Model</span><span class="p">.</span><span class="nc">findOne</span><span class="o">(</span><span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;borne&#39;</span> <span class="p">}</span><span class="o">,</span> <span class="nt">function</span> <span class="o">(</span><span class="nt">err</span><span class="o">,</span> <span class="nt">doc</span><span class="o">)</span> <span class="p">{</span>
  <span class="err">if</span> <span class="err">(err)</span> <span class="err">..</span>
  <span class="err">doc.name</span> <span class="err">=</span> <span class="err">&#39;jason</span> <span class="err">bourne&#39;</span><span class="p">;</span>
  <span class="err">doc.save(callback)</span><span class="p">;</span>
<span class="p">}</span><span class="o">)</span>
</code></pre></div>

<h2 id="modelupdatemany">Model.updateMany()<a class="headerlink" href="#modelupdatemany" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Same as <code>update()</code>, except MongoDB will update <em>all</em> documents that match <code>criteria</code> (as opposed to just the first one) regardless of the value of the <code>multi</code> option.</p>
<p><strong>Note</strong> updateMany will <em>not</em> fire update middleware. Use <code>pre('updateMany')</code> and <code>post('updateMany')</code> instead.</p>
<p>This function triggers the following middleware.</p>
<h2 id="modelupdateone">Model.updateOne()<a class="headerlink" href="#modelupdateone" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Same as <code>update()</code>, except MongoDB will update <em>only</em> the first document that matches <code>criteria</code> regardless of the value of the <code>multi</code> option.</p>
<p>This function triggers the following middleware.</p>
<h2 id="modelreplaceone">Model.replaceOne()<a class="headerlink" href="#modelreplaceone" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Same as <code>update()</code>, except MongoDB replace the existing document with the given document (no atomic operators like <code>$set</code>).</p>
<p>This function triggers the following middleware.</p>
<h2 id="modelmapreduce">Model.mapReduce()<a class="headerlink" href="#modelmapreduce" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» optional callback</li>
</ul>
<p><strong>返回</strong></p>
<p>Executes a mapReduce command.</p>
<p><code>o</code> is an object specifying all mapReduce options as well as the map and reduce functions. All options are delegated to the driver implementation. See [node-mongodb-native mapReduce() documentation for more detail about options.</p>
<p>This function does not trigger any middleware.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="k">var</span> <span class="n">o</span> <span class="o">=</span> <span class="p">{};</span>
<span class="n">o</span><span class="o">.</span><span class="n">map</span> <span class="o">=</span> <span class="n">function</span> <span class="p">()</span> <span class="p">{</span> <span class="n">emit</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">}</span>
<span class="n">o</span><span class="o">.</span><span class="n">reduce</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">vals</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">vals</span><span class="o">.</span><span class="n">length</span> <span class="p">}</span>
<span class="n">User</span><span class="o">.</span><span class="n">mapReduce</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div>

<p><strong>其他选项</strong></p>
<ul>
<li><code>query</code> {Object} query filter object.</li>
<li><code>sort</code> {Object} sort input objects using this key</li>
<li><code>limit</code> {Number} max number of documents</li>
<li><code>keeptemp</code> {Boolean, default:false} keep temporary data</li>
<li><code>finalize</code> {Function} finalize function</li>
<li><code>scope</code> {Object} scope variables exposed to map/reduce/finalize during execution</li>
<li><code>jsMode</code> {Boolean, default:false} it is possible to make the execution stay in JS. Provided in MongoDB &gt; 2.0.X</li>
<li><code>verbose</code> {Boolean, default:false} provide statistics on job execution time.</li>
<li><code>readPreference</code> {String}</li>
<li><code>out*</code> {Object, default: {inline:1}} sets the output target for the map reduce job.</li>
</ul>
<p><strong>输出选项</strong></p>
<ul>
<li><code>{inline:1}</code> the results are returned in an array</li>
<li><code>{replace: 'collectionName'}</code> add the results to collectionName: the results replace the collection</li>
<li><code>{reduce: 'collectionName'}</code> add the results to collectionName: if dups are detected, uses the reducer / finalize functions</li>
<li><code>{merge: 'collectionName'}</code> add the results to collectionName: if dups exist the new docs overwrite the old</li>
</ul>
<p>If <code>options.out</code> is set to <code>replace</code>, <code>merge</code>, or <code>reduce</code>, a Model instance is returned that can be used for further querying. Queries run against this model are all executed with the <code>lean</code> option; meaning only the js object is returned and no Mongoose magic is applied (getters, setters, etc).</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="k">var</span> <span class="n">o</span> <span class="o">=</span> <span class="p">{};</span>
<span class="n">o</span><span class="o">.</span><span class="n">map</span> <span class="o">=</span> <span class="n">function</span> <span class="p">()</span> <span class="p">{</span> <span class="n">emit</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">}</span>
<span class="n">o</span><span class="o">.</span><span class="n">reduce</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">vals</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">vals</span><span class="o">.</span><span class="n">length</span> <span class="p">}</span>
<span class="n">o</span><span class="o">.</span><span class="n">out</span> <span class="o">=</span> <span class="p">{</span> <span class="n">replace</span><span class="p">:</span> <span class="s1">&#39;createdCollectionNameForResults&#39;</span> <span class="p">}</span>
<span class="n">o</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">true</span><span class="p">;</span>

<span class="n">User</span><span class="o">.</span><span class="n">mapReduce</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">stats</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;map reduce took </span><span class="si">%d</span><span class="s1"> ms&#39;</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">processtime</span><span class="p">)</span>
  <span class="n">model</span><span class="o">.</span><span class="n">find</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">docs</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">docs</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">})</span>



<span class="n">o</span><span class="o">.</span><span class="n">resolveToObject</span> <span class="o">=</span> <span class="bp">true</span><span class="p">;</span>
<span class="k">var</span> <span class="n">promise</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">mapReduce</span><span class="p">(</span><span class="n">o</span><span class="p">);</span>
<span class="n">promise</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">function</span> <span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">var</span> <span class="n">model</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">model</span><span class="p">;</span>
  <span class="k">var</span> <span class="n">stats</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">stats</span><span class="p">;</span>
  <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;map reduce took </span><span class="si">%d</span><span class="s1"> ms&#39;</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">processtime</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">find</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">exec</span><span class="p">();</span>
<span class="p">})</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">function</span> <span class="p">(</span><span class="n">docs</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">docs</span><span class="p">);</span>
<span class="p">})</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="nb nb-Type">null</span><span class="p">,</span> <span class="n">handleError</span><span class="p">)</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</code></pre></div>

<h2 id="modelaggregate">Model.aggregate()<a class="headerlink" href="#modelaggregate" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<p><strong>返回</strong></p>
<p>Performs [aggregations on the models collection.</p>
<p>If a <code>callback</code> is passed, the <code>aggregate</code> is executed and a <code>Promise</code> is returned. If a callback is not passed, the <code>aggregate</code> itself is returned.</p>
<p>This function does not trigger any middleware.</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">Users</span><span class="p">.</span><span class="n">aggregate</span><span class="p">(</span>
  <span class="p">{</span> <span class="n">$group</span><span class="o">:</span> <span class="p">{</span> <span class="nl">_id:</span> <span class="n">null</span><span class="p">,</span> <span class="nl">maxBalance:</span> <span class="p">{</span> <span class="n">$max</span><span class="o">:</span> <span class="p">&#39;</span><span class="n">$balance</span><span class="p">&#39;</span> <span class="p">}}},</span>
  <span class="p">{</span> <span class="n">$project</span><span class="o">:</span> <span class="p">{</span> <span class="nl">_id:</span> <span class="mh">0</span><span class="p">,</span> <span class="nl">maxBalance:</span> <span class="mh">1</span> <span class="p">}},</span>
  <span class="k">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="k">return</span> <span class="n">handleError</span><span class="p">(</span><span class="n">err</span><span class="p">);</span>
    <span class="n">console</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
  <span class="p">});</span>


<span class="n">Users</span><span class="p">.</span><span class="n">aggregate</span><span class="p">()</span>
  <span class="p">.</span><span class="n">group</span><span class="p">({</span> <span class="nl">_id:</span> <span class="n">null</span><span class="p">,</span> <span class="nl">maxBalance:</span> <span class="p">{</span> <span class="n">$max</span><span class="o">:</span> <span class="p">&#39;</span><span class="n">$balance</span><span class="p">&#39;</span> <span class="p">}</span> <span class="p">})</span>
  <span class="p">.</span><span class="n">select</span><span class="p">(&#39;</span><span class="o">-</span><span class="n">id</span> <span class="n">maxBalance</span><span class="p">&#39;)</span>
  <span class="p">.</span><span class="n">exec</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="k">return</span> <span class="n">handleError</span><span class="p">(</span><span class="n">err</span><span class="p">);</span>
    <span class="n">console</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>

<p><strong>注释</strong></p>
<ul>
<li>Arguments are not cast to the model's schema because <code>$project</code> operators allow redefining the "shape" of the documents at any stage of the pipeline, which may leave documents in an incompatible format.</li>
<li>The documents returned are plain javascript objects, not mongoose documents (since any shape of document can be returned).</li>
<li>Requires MongoDB &gt;= 2.1</li>
</ul>
<hr />
<h2 id="modelgeosearch">Model.geoSearch()<a class="headerlink" href="#modelgeosearch" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback] «Function» optional callback</li>
</ul>
<p><strong>返回</strong></p>
<p>Implements <code>$geoSearch</code> functionality for Mongoose</p>
<p>This function does not trigger any middleware</p>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="k">var</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span> <span class="n">near</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">maxDistance</span><span class="p">:</span> <span class="mi">5</span> <span class="p">};</span>
<span class="n">Locations</span><span class="o">.</span><span class="n">geoSearch</span><span class="p">({</span> <span class="n">type</span> <span class="p">:</span> <span class="s2">&quot;house&quot;</span> <span class="p">},</span> <span class="n">options</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>

<p><strong>选项</strong></p>
<ul>
<li><code>near</code> {Array} x,y point to search for</li>
<li><code>maxDistance</code> {Number} the maximum distance from the point near that a result can be</li>
<li><code>limit</code> {Number} The maximum number of results to return</li>
<li><code>lean</code> {Boolean} return the raw object instead of the Mongoose Model</li>
</ul>
<hr />
<h2 id="modelpopulate">Model.populate()<a class="headerlink" href="#modelpopulate" title="Permanent link">&para;</a></h2>
<p><strong>参数</strong></p>
<ul>
<li>[callback(err,doc)] «Function» Optional callback, executed upon completion. Receives <code>err</code> and the <code>doc(s)</code>.</li>
</ul>
<p><strong>返回</strong></p>
<p>Populates document references.</p>
<p><strong>可用的选项</strong></p>
<ul>
<li>path: space delimited path(s) to populate</li>
<li>select: optional fields to select</li>
<li>match: optional query conditions to match</li>
<li>model: optional name of the model to use for population</li>
<li>options: optional query options like sort, limit, etc</li>
</ul>
<p><strong>示例</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">User</span><span class="o">.</span><span class="n">findById</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">var</span> <span class="n">opts</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">{</span> <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;company&#39;</span><span class="p">,</span> <span class="k">match</span><span class="p">:</span> <span class="p">{</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="n">select</span><span class="p">:</span> <span class="s1">&#39;name&#39;</span> <span class="p">}</span>
    <span class="p">,</span> <span class="p">{</span> <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;notes&#39;</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="p">{</span> <span class="n">limit</span><span class="p">:</span> <span class="mi">10</span> <span class="p">},</span> <span class="n">model</span><span class="p">:</span> <span class="s1">&#39;override&#39;</span> <span class="p">}</span>
  <span class="p">]</span>

  <span class="n">User</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">opts</span><span class="p">,</span> <span class="n">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">user</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>


<span class="n">User</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="k">match</span><span class="p">,</span> <span class="n">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">users</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">var</span> <span class="n">opts</span> <span class="o">=</span> <span class="p">[{</span> <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;company&#39;</span><span class="p">,</span> <span class="k">match</span><span class="p">:</span> <span class="p">{</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="n">select</span><span class="p">:</span> <span class="s1">&#39;name&#39;</span> <span class="p">}]</span>

  <span class="k">var</span> <span class="n">promise</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="n">users</span><span class="p">,</span> <span class="n">opts</span><span class="p">);</span>
  <span class="n">promise</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">)</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
<span class="p">})</span>










<span class="k">var</span> <span class="n">user</span> <span class="o">=</span> <span class="p">{</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Indiana Jones&#39;</span><span class="p">,</span> <span class="n">weapon</span><span class="p">:</span> <span class="mi">389</span> <span class="p">}</span>
<span class="n">Weapon</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="p">{</span> <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;weapon&#39;</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="s1">&#39;Weapon&#39;</span> <span class="p">},</span> <span class="n">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">weapon</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="p">})</span>


<span class="k">var</span> <span class="n">users</span> <span class="o">=</span> <span class="p">[{</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Indiana Jones&#39;</span><span class="p">,</span> <span class="n">weapon</span><span class="p">:</span> <span class="mi">389</span> <span class="p">}]</span>
<span class="n">users</span><span class="o">.</span><span class="n">push</span><span class="p">({</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Batman&#39;</span><span class="p">,</span> <span class="n">weapon</span><span class="p">:</span> <span class="mi">8921</span> <span class="p">})</span>
<span class="n">Weapon</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="n">users</span><span class="p">,</span> <span class="p">{</span> <span class="n">path</span><span class="p">:</span> <span class="s1">&#39;weapon&#39;</span> <span class="p">},</span> <span class="n">function</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">users</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">users</span><span class="o">.</span><span class="n">forEach</span><span class="p">(</span><span class="n">function</span> <span class="p">(</span><span class="n">user</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> uses a </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">users</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">weapon</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>


  <span class="p">});</span>
<span class="p">});</span>
</code></pre></div>

<hr />
<hr />
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../guide/" class="md-footer__link md-footer__link--prev" aria-label="上一页: 模型手册" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                上一页
              </span>
              模型手册
            </div>
          </div>
        </a>
      
      
        
        <a href="../../document/guide/" class="md-footer__link md-footer__link--next" aria-label="下一页: 文档手册" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                下一页
              </span>
              文档手册
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            版权 &copy; 2022 -  wdk-docs.github.io
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="http://wdk-docs.github.io" target="_blank" rel="noopener" title="wdk-docs.github.io" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://github.com/wdk-docs" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/wdk-docs" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://linkedin.com/in/wdk-docs" target="_blank" rel="noopener" title="linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.e99e714c.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.bc35569b.min.js"></script>
      
    
  </body>
</html>